<div class="container-fluid">
  <div class="row justify-content-center">
    <div class="col-11">
      <p class="py-3 text-color-primary pointer">
        <span (click)="navigateTo('/')">Home</span> /
        <span>Cart</span>
      </p>
    </div>
    <div class="col-11 py-4">
      <h1 class="p-4 regular-weight">Shopping Cart</h1>
    </div>
    <div class="col-11">
      <div class="row">
        <div class="col-12 col-md-12 col-lg-8 px-3">
          <div class="row border-bottom pb-2 d-none d-md-none d-lg-flex">
            <div class="col-3 text-center">Product</div>
            <div class="col-3 text-center">Price</div>
            <div class="col-3 text-center">Qty</div>
            <div class="col-3 ps-5">Total</div>
          </div>
          <div
            class="row border-bottom p-2"
            *ngFor="let p of carts; let i = index"
          >
            <div class="col-12 col-sm-6 col-md-7 col-lg-3 text-center d-flex">
              <img
                width="100"
                height="90"
                [src]="p?.cartWithVariants?.variantImages[0].image"
                alt=""
              />
              <div class="p-3">
                <p class="light-dark regular-font">
                  {{
                p?.cartWithVariants?.sku }}
                </p>
                <p
                  class="text-muted small-text attr"
                  *ngFor="
                    let item of p?.cartWithVariants?.variantWithAttrVariantMap
                  "
                >
                  {{ item?.AttrVariantMapWithAttributes.name }} :
                  <ng-container *ngIf="item?.AttrVariantMapWithAttributes?.type == 'color'"> <i class="fa-solid fa-square" [ngStyle]="{'background-color':item?.value}" ></i></ng-container>
                  <ng-container *ngIf="item?.AttrVariantMapWithAttributes?.type != 'color'"> {{ item?.value }}</ng-container>
                 
                </p>
              </div>
            </div>
            <div class="offSet col-1 col-md-1 col-lg-3 text-center light-dark small-text my-auto">
              {{ p?.cartWithVariants?.price | currency : 'CAD' }}
            </div>
            <div class="col-4 col-sm-2 col-md-2 col-lg-3 text-center my-auto">
              <input
                type="number"
                min="0"
                [class.borderDanger]="p.error"
                class="w-50 input-number background-primary"
                [(ngModel)]="p.qty"
                (change)="showUpdate = !showUpdate"
              />
            </div>
            <div class="col-2 col-md-1 col-lg-2 text-center light-dark small-text my-auto">
              <p class="py-auto">
                {{p?.cartWithVariants?.price  * p?.qty | currency : 'CAD' }}
              </p>
            </div>
            <div class="col-1 col-md-1 col-lg-1 text-center my-auto">
              <span
                ><i
                  class="fa-regular fa-trash-can pointer"
                  (click)="deleteVariant(p.id)"
                ></i
              ></span>
            </div>
          </div>
          <div class="row py-5">
            <div class="col-3 mb-3" *ngIf="showUpdate">
              <button class="btn btn-dark" (click)="updateAllCart()">
                Update
              </button>
            </div>
            <div class="col-12">
              <div class="w-50">
                <button class="btn btn-dark" (click)="navigateTo('/home')">
                  Continue Shopping
                </button>
              </div>
            </div>
          </div>
        </div>
        <div class="col-12 col-md-12 col-lg-4">
          <div class="card rounded-0">
            <div class="p-3">
              <div class="row justify-content-between">
                <div class="col-4 regular-weight">
                  {{ carts?.length }}
                  {{ carts?.length < 1 ? "item" : "items" }}
                </div>
                <div class="col-4 d-flex justify-content-end regular-weight">
                  {{ totalItemPrice | currency : 'CAD' }}
                </div>
              </div>
              <!-- <div class="row justify-content-between">
                <div class="col-4 regular-weight">Shipping</div>
                <div class="col-4 d-flex justify-content-end regular-weight">
                  {{ 7 | currency : 'CAD' }}
                </div>
              </div> -->
            </div>
            <div class="card-body p-3">
              <div class="row justify-content-between">
                <div class="col-4">
                  <h5 class="regular-weight">Total (tax incl.)</h5>
                </div>
                <div class="col-4 d-flex justify-content-end">
                  <h5 class="regular-weight">
                    {{ totalItemPrice | currency : 'CAD' }}
                  </h5>
                </div>
              </div>
              <div class="row">
                <div class="col-12 description">
                  <p>Spend $168.50 more to get free shipping!</p>
                  <p class="regular-weight">
                    IQITFREEDELIVERYCOUNT - module, you can put own text in
                    configuration
                  </p>
                </div>
              </div>
            </div>
            <div class="row p-4 background-primary">
              <div class="col-2">
                <i class="fa-solid fa-tag"></i>
              </div>
              <div class="col-7">
                <p class="regular-weight">Promo Code</p>
              </div>
              <div class="col-3 d-flex justify-content-end">
                <p class="regular-weight">Add</p>
              </div>
            </div>
            <div class="row p-3">
              <div class="col-12">
                <button
                  class="btn btn-dark py-3 regular-weight"
                  (click)="checkout()"
                >
                  Proceed to checkout
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
