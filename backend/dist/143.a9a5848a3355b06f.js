"use strict";(self.webpackChunkmantis_free_version=self.webpackChunkmantis_free_version||[]).push([[143],{4495:(I,y,a)=>{a.d(y,{s:()=>r});var h=a(9862),t=a(3997),m=a(7398),_=a(8645),O=a(4552);class U extends _.x{constructor(p=1/0,l=1/0,o=O.l){super(),this._bufferSize=p,this._windowTime=l,this._timestampProvider=o,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=l===1/0,this._bufferSize=Math.max(1,p),this._windowTime=Math.max(1,l)}next(p){const{isStopped:l,_buffer:o,_infiniteTimeWindow:u,_timestampProvider:g,_windowTime:v}=this;l||(o.push(p),!u&&o.push(g.now()+v)),this._trimBuffer(),super.next(p)}_subscribe(p){this._throwIfClosed(),this._trimBuffer();const l=this._innerSubscribe(p),{_infiniteTimeWindow:o,_buffer:u}=this,g=u.slice();for(let v=0;v<g.length&&!p.closed;v+=o?1:2)p.next(g[v]);return this._checkFinalizedStatuses(p),l}_trimBuffer(){const{_bufferSize:p,_timestampProvider:l,_buffer:o,_infiniteTimeWindow:u}=this,g=(u?1:2)*p;if(p<1/0&&g<o.length&&o.splice(0,o.length-g),!u){const v=l.now();let A=0;for(let T=1;T<o.length&&o[T]<=v;T+=2)A=T;A&&o.splice(0,A+1)}}}var x=a(3020);function b(d,p,l){let o,u=!1;return d&&"object"==typeof d?({bufferSize:o=1/0,windowTime:p=1/0,refCount:u=!1,scheduler:l}=d):o=d??1/0,(0,x.B)({connector:()=>new U(o,p,l),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:u})}var Z=a(5879);let r=(()=>{class d{constructor(l){this.httpClient=l,this.options={headers:(new h.WM).set("Content-Type","application/json")}}private(){return`${location.protocol}//${location.hostname+(location.port?":"+location.port:"")}/`}get(l,o=new h.LE){return(0,t.x)(),this.httpClient.get(l,{params:o}).pipe((0,m.U)(u=>u.result),b())}put(l,o={}){return(0,t.x)(),this.httpClient.put(l,o).pipe((0,m.U)(u=>u.result))}post(l,o={}){return(0,t.x)(),this.httpClient.post(l,o).pipe((0,m.U)(u=>u.result))}delete(l){return(0,t.x)(),this.httpClient.delete(l).pipe((0,m.U)(o=>o.result),b())}getFile(l,o=new h.LE){return this.httpClient.get(l,{responseType:"blob",headers:(new h.WM).append("Content-Type","application/json")})}getIp(){return(0,t.x)(),this.httpClient.get("https://ipapi.co/json/").pipe(b())}static#t=this.\u0275fac=function(o){return new(o||d)(Z.LFG(h.eN))};static#e=this.\u0275prov=Z.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"})}return d})()},3143:(I,y,a)=>{a.r(y),a.d(y,{OffersModule:()=>M});var h=a(1076),t=a(5879),m=a(7285),_=a(7398),O=a(4495);let U=(()=>{class s{constructor(e){this.http=e,this.routes={createPath:"offers/create",getAllPath:"offers/getAll",getAllMasterDataPath:"offers/getAllMasterData",updatePath:i=>`offers/update/${i}`,getByIdPath:i=>`offers/getById/${i}`,deletePath:i=>`offers/delete/${i}`}}create(e){return this.http.post(this.routes.createPath,e).pipe((0,_.U)(i=>i))}getAll(e){return this.http.get(this.routes.getAllPath,e).pipe((0,_.U)(i=>i))}getAllMasterData(e){return this.http.get(this.routes.getAllMasterDataPath,e).pipe((0,_.U)(i=>i))}update(e,i){return this.http.put(this.routes.updatePath(e),i).pipe((0,_.U)(n=>n))}getById(e){return this.http.get(this.routes.getByIdPath(e)).pipe((0,_.U)(i=>i))}delete(e){return this.http.delete(this.routes.deletePath(e)).pipe((0,_.U)(i=>i))}static#t=this.\u0275fac=function(i){return new(i||s)(t.LFG(O.s))};static#e=this.\u0275prov=t.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})();var x=a(4087),b=a(485),Z=a(6814),r=a(95),d=a(7741);function p(s,C){if(1&s&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&s){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",null==e?null:e.discountPercentage,"% ")}}function l(s,C){if(1&s&&(t._uU(0),t.ALo(1,"currency")),2&s){const e=t.oxw().$implicit;t.hij(" ",t.xi3(1,1,null==e?null:e.discountAmount,"INR")," ")}}function o(s,C){if(1&s){const e=t.EpF();t.TgZ(0,"tr")(1,"td",26),t._uU(2),t.qZA(),t.TgZ(3,"td",26),t._uU(4),t.qZA(),t.TgZ(5,"td",26),t._uU(6),t.qZA(),t.TgZ(7,"td",26),t._uU(8),t.ALo(9,"date"),t.qZA(),t.TgZ(10,"td",26),t.YNc(11,p,2,1,"span",27),t.YNc(12,l,2,4,"ng-template",null,28,t.W1O),t.qZA(),t.TgZ(14,"td",26)(15,"span"),t._uU(16),t.ALo(17,"titlecase"),t.qZA()(),t.TgZ(18,"td",29),t.ynx(19),t.TgZ(20,"button",30),t.NdJ("click",function(){const c=t.CHM(e).$implicit,f=t.oxw();return t.KtG(f.navigateTo("/default/offers/offers-form",null==c?null:c._id))}),t._UZ(21,"i",31),t.qZA(),t.TgZ(22,"button",32),t.NdJ("click",function(){const c=t.CHM(e).$implicit,f=t.oxw(),S=t.MAs(41);return t.KtG(f.open(c,S))}),t._UZ(23,"i",33),t.qZA(),t.BQk(),t.qZA()()}if(2&s){const e=C.$implicit,i=C.index,n=t.MAs(13);t.xp6(2),t.Oqu(i+1),t.xp6(2),t.Oqu(null==e?null:e.title),t.xp6(2),t.Oqu(null==e?null:e.products),t.xp6(2),t.Oqu(t.lcZ(9,10,null==e?null:e.expirationDate)),t.xp6(3),t.Q6J("ngIf",null==e?null:e.discountPercentage)("ngIfElse",n),t.xp6(4),t.Gre("badge rounded-pill  text-bg-","active"==e.status?"success":"danger"," px-2"),t.xp6(1),t.hij(" ",t.lcZ(17,12,e.status),"")}}function u(s,C){if(1&s){const e=t.EpF();t.TgZ(0,"div",34)(1,"button",35),t.NdJ("click",function(){const c=t.CHM(e).$implicit;return t.KtG(c.dismiss("Cross click"))}),t.qZA()(),t.TgZ(2,"div",36)(3,"h2",37),t._uU(4),t.qZA(),t.TgZ(5,"h4",38),t._uU(6," Are you sure you want to Delete ? "),t.qZA()(),t.TgZ(7,"div",39)(8,"button",40),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.delete(null==n.selectedRow?null:n.selectedRow._id))}),t._uU(9," YES "),t.qZA(),t.TgZ(10,"button",41),t.NdJ("click",function(){const c=t.CHM(e).$implicit;return t.KtG(c.dismiss("Cross click"))}),t._uU(11," NO "),t.qZA()()}if(2&s){const e=t.oxw();t.xp6(4),t.hij(" ",null==e.selectedRow?null:e.selectedRow.offersName," ")}}let g=(()=>{class s{constructor(e,i,n,c,f){this.router=e,this.offersService=i,this.activated=n,this.spinner=c,this.toastService=f,this.modalService=(0,t.f3M)(m.FF),this.page=1,this.pageSize=25,this.collection=0,this.column="createdAt",this.direction=-1,this.search="",this.offers=[],this.address=""}ngOnInit(){this.getAll()}navigateTo(e,i){i?this.router.navigate([e],{queryParams:{id:i}}):this.router.navigate([e])}open(e,i){this.selectedRow=e,this.modalService.open(i,{centered:!0})}searchFn(){(this.search.toString().length>=3||0==this.search.toString().length)&&this.getAll()}delete(e){this.spinner.show(),this.offersService.delete(e).subscribe(i=>{this.spinner.hide(),this.toastService.success(i.message),this.modalService.dismissAll(),this.getAll()})}onChangePage(e){e>0&&(this.page=e),this.getAll()}getAll(){this.spinner.show(),this.offersService.getAll({page:this.page,pageSize:this.pageSize,search:this.search}).subscribe(i=>{this.spinner.hide(),this.offers=i.rows.map(n=>(n.products=n.products.map(c=>c.code),n)),this.collection=i.count})}static#t=this.\u0275fac=function(i){return new(i||s)(t.Y36(h.F0),t.Y36(U),t.Y36(h.gz),t.Y36(x.V),t.Y36(b.k))};static#e=this.\u0275cmp=t.Xpm({type:s,selectors:[["app-offers-list"]],decls:42,vars:5,consts:[[1,"table-container"],[1,"card","table-card"],[1,"card-title"],[1,"card-header"],[1,"row","justify-content-between"],[1,"col-4"],[1,"input-icons"],[1,"input-group","input-group-sm"],["type","search","aria-label","Small","placeholder","Search","aria-describedby","inputGroup-sizing-sm",1,"form-control",3,"ngModel","ngModelChange","input"],[1,"input-group-append"],["id","inputGroup-sizing-sm",1,"input-group-text","h-100"],[1,"ti","ti-search"],[1,"col-md-4","col-3","text-right"],[1,"btn","add-btn",3,"click"],[1,"ti","ti-plus","me-1"],[1,"card-body","p-3"],[1,"table-responsive"],[1,"table","table-hover","table-bordered"],[1,"thead"],[1,"table-secondary"],["scope","col"],["scope","col",1,"mx-auto","text-center"],[1,"tbody","mt-3"],[4,"ngFor","ngForOf"],[3,"page","pageSize","collection","pageChange","pageSizeChange","collectionChange","myOutput"],["deleteModal",""],["scope","row"],[4,"ngIf","ngIfElse"],["elseBlock",""],["scope","row",1,"text-center"],["ngbTooltip","Update",1,"btn","action-btn","btn-sm","mx-2",3,"click"],[1,"ti","ti-edit-circle"],["ngbTooltip","Delete",1,"btn","action-btn","btn-sm",3,"click"],[1,"ti","ti-trash"],[1,"modal-header","border-0"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body","border-0"],["id","modal-basic-title",1,"modal-title","text-center","text-primary"],["id","modal-basic-title",1,"modal-title","text-center"],[1,"modal-footer","justify-content-center","border-0"],["type","button",1,"btn","px-4","btn-danger",3,"click"],["type","button",1,"btn","px-4","btn-primary",3,"click"]],template:function(i,n){1&i&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3"),t._uU(4,"Offer List"),t.qZA()(),t.TgZ(5,"div",3)(6,"div",4)(7,"div",5)(8,"div",6)(9,"div",7)(10,"input",8),t.NdJ("ngModelChange",function(f){return n.search=f})("input",function(){return n.searchFn()}),t.qZA(),t.TgZ(11,"div",9)(12,"span",10),t._UZ(13,"i",11),t.qZA()()()()(),t.TgZ(14,"div",12)(15,"button",13),t.NdJ("click",function(){return n.navigateTo("/default/offers/offers-form",null)}),t._UZ(16,"i",14),t._uU(17," Add Offer "),t.qZA()()()(),t.TgZ(18,"div",15)(19,"div",16)(20,"table",17)(21,"thead",18)(22,"tr",19)(23,"th",20),t._uU(24,"Sr. No."),t.qZA(),t.TgZ(25,"th",20),t._uU(26,"Title"),t.qZA(),t.TgZ(27,"th",20),t._uU(28,"Products"),t.qZA(),t.TgZ(29,"th",20),t._uU(30,"Expiration Date"),t.qZA(),t.TgZ(31,"th",20),t._uU(32,"Discount"),t.qZA(),t.TgZ(33,"th",20),t._uU(34,"Status"),t.qZA(),t.TgZ(35,"th",21),t._uU(36,"Action"),t.qZA()()(),t.TgZ(37,"tbody",22),t.YNc(38,o,24,14,"tr",23),t.qZA()()(),t.TgZ(39,"app-custom-pagination",24),t.NdJ("pageChange",function(f){return n.page=f})("pageSizeChange",function(f){return n.pageSize=f})("collectionChange",function(f){return n.collection=f})("myOutput",function(){return n.onChangePage(n.page)}),t.qZA()()()(),t.YNc(40,u,12,1,"ng-template",null,25,t.W1O)),2&i&&(t.xp6(10),t.Q6J("ngModel",n.search),t.xp6(28),t.Q6J("ngForOf",n.offers),t.xp6(1),t.Q6J("page",n.page)("pageSize",n.pageSize)("collection",n.collection))},dependencies:[m._L,Z.sg,Z.O5,r.Fj,r.JJ,r.On,d.W,Z.rS,Z.H9,Z.uU],encapsulation:2})}return s})();var v=a(9769),A=a(2096),T=a(6857),F=a(4807);let q=(()=>{class s{constructor(e,i,n,c,f,S,P){this.router=e,this.spinner=i,this.validationService=n,this.activated=c,this.offersService=f,this.toastService=S,this.modelService=P,this.submitted=!1,this.userId=null,this.today=(new Date).toISOString().split("T")[0],this.productOptions=[],this.offersForm=new r.cw({_id:new r.NI(null),productIds:new r.NI([],[r.kI.required]),title:new r.NI(null,[r.kI.required]),discountPercentage:new r.NI(null),discountAmount:new r.NI(null),expirationDate:new r.NI(null,[r.kI.required]),status:new r.NI("active")}),this.FORM_ERRORS=[{message:"Coupon Code is Required",key:"title"},{message:"Description is Required",key:"productIds"},{message:"Expiration Date is Required",key:"expirationDate"}]}get f(){return this.offersForm.controls}ngOnInit(){this.getInitialData()}navigateTo(e){this.router.navigate([e])}submit(){if(this.submitted=!0,this.validationService.checkErrors(this.offersForm,this.FORM_ERRORS))return;let e=this.offersForm.value;e._id?(delete e.password,this.update(e)):(delete e._id,this.create(e))}create(e){this.spinner.show(),this.offersService.create(e).subscribe(i=>{this.spinner.hide(),this.toastService.success(i.message),this.router.navigate(["default/offers/offers-list"])})}update(e){this.spinner.show(),this.offersService.update(e._id,e).subscribe(i=>{this.spinner.hide(),this.toastService.success(i.message),this.router.navigate(["/default/offers/offers-list"])})}getInitialData(){this.offersService.getAllMasterData({}).subscribe(e=>{this.productOptions=e.products,this.activated.queryParams.pipe((0,v.z)(i=>i.id?this.offersService.getById(i.id):(0,A.of)({}))).subscribe(i=>{i.expirationDate&&(i.expirationDate=i.expirationDate.split("T")[0]),this.offersForm.patchValue(i)})})}reset(){this.offersForm.reset(),this.getInitialData()}static#t=this.\u0275fac=function(i){return new(i||s)(t.Y36(h.F0),t.Y36(x.V),t.Y36(T.R),t.Y36(h.gz),t.Y36(U),t.Y36(b.k),t.Y36(m.FF))};static#e=this.\u0275cmp=t.Xpm({type:s,selectors:[["app-offers-form"]],decls:59,vars:12,consts:[[1,"card","form-card"],[1,"card-header"],[1,"card-header-items"],[1,"ms-2"],[1,"back-btn","btn","btn-primary",3,"click"],[1,"ti","ti-arrow-left","me-1"],[1,"card-body"],[3,"formGroup"],[1,"row"],[1,"col-md-6","mb-2"],[1,"form-label"],[1,"text-danger"],["formControlName","title","placeholder","Title","type","text",1,"form-control"],["placeholder","Select Products","bindLabel","label","bindValue","_id","formControlName","productIds",1,"ng-select-lg",3,"items","clearable","multiple"],["formControlName","expirationDate","placeholder","Expiration Date","type","date",1,"form-control",3,"min"],[1,"col-md-6"],["formControlName","status",1,"form-control"],["selected","","disabled","",3,"value"],["value","active"],["value","inactive"],["formControlName","discountPercentage","placeholder","Discount Percentage","type","number","min","0","max","100",1,"form-control"],["formControlName","discountAmount","placeholder","Discount Amount","type","number",1,"form-control"],[1,"my-3"],[1,"col-12"],[1,"d-flex","justify-content-center"],["type","submit",1,"btn","reset-btn","btn-primary",3,"click"],[1,"fa-solid","fa-arrows-rotate","me-2"],["type","submit",1,"btn","submit-btn",3,"click"],[1,"fa-solid","me-2"]],template:function(i,n){1&i&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),t._uU(4),t.qZA(),t.TgZ(5,"div")(6,"a",4),t.NdJ("click",function(){return n.navigateTo("/default/offers/offers-list")}),t._UZ(7,"i",5),t._uU(8," Back"),t.qZA()()()(),t.TgZ(9,"div",6)(10,"form",7)(11,"div",8)(12,"div",9)(13,"label",10),t._uU(14," Title "),t.TgZ(15,"span",11),t._uU(16,"*"),t.qZA()(),t._UZ(17,"input",12),t.qZA(),t.TgZ(18,"div",9)(19,"label",10),t._uU(20," Products "),t.TgZ(21,"span",11),t._uU(22,"*"),t.qZA()(),t._UZ(23,"ng-select",13),t.qZA()(),t.TgZ(24,"div",8)(25,"div",9)(26,"label",10),t._uU(27," Expiration Date "),t.qZA(),t._UZ(28,"input",14),t.qZA(),t.TgZ(29,"div",15)(30,"label",10),t._uU(31," Status "),t.TgZ(32,"span",11),t._uU(33,"*"),t.qZA()(),t.TgZ(34,"select",16)(35,"option",17),t._uU(36,"Select Status"),t.qZA(),t.TgZ(37,"option",18),t._uU(38,"Active"),t.qZA(),t.TgZ(39,"option",19),t._uU(40,"InActive"),t.qZA()()(),t.TgZ(41,"div",9)(42,"label",10),t._uU(43," Discount Percentage "),t.qZA(),t._UZ(44,"input",20),t.qZA(),t.TgZ(45,"div",15)(46,"label",10),t._uU(47," Discount Amount "),t.qZA(),t._UZ(48,"input",21),t.qZA()(),t._UZ(49,"hr",22),t.TgZ(50,"div",8)(51,"div",23)(52,"div",24)(53,"button",25),t.NdJ("click",function(){return n.reset()}),t._UZ(54,"i",26),t._uU(55," Reset "),t.qZA(),t.TgZ(56,"button",27),t.NdJ("click",function(){return n.submit()}),t._UZ(57,"i",28),t._uU(58),t.qZA()()()()()()()),2&i&&(t.xp6(4),t.Oqu(n.userId?"Update":"Create"),t.xp6(6),t.Q6J("formGroup",n.offersForm),t.xp6(13),t.Q6J("items",n.productOptions)("clearable",!1)("multiple",!0),t.xp6(5),t.Q6J("min",n.today),t.xp6(7),t.Q6J("value",null),t.xp6(21),t.Tol(n.userId?"btn-warning":"btn-success"),t.xp6(1),t.Tol(n.userId?"fa-pen-to-square":"fa-plus"),t.xp6(1),t.hij(" ",n.userId?"Update":"Create"," "))},dependencies:[F.w9,r._Y,r.YN,r.Kr,r.Fj,r.wV,r.EJ,r.JJ,r.JL,r.qQ,r.Fd,r.sg,r.u],encapsulation:2})}return s})();var w=a(8672),N=a(4086);const L=[{path:"",redirectTo:"offers-list",pathMatch:"full"},{path:"offers-list",component:g},{path:"offers-form",component:q}];let M=(()=>{class s{static#t=this.\u0275fac=function(i){return new(i||s)};static#e=this.\u0275mod=t.oAB({type:s});static#i=this.\u0275inj=t.cJS({imports:[m.HK,w.ef,h.Bz.forChild(L),N.m,d.W]})}return s})()}}]);