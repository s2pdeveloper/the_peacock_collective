"use strict";(self.webpackChunkmantis_free_version=self.webpackChunkmantis_free_version||[]).push([[480],{4495:(q,U,l)=>{l.d(U,{s:()=>x});var m=l(9862),g=l(3997),i=l(7398),t=l(8645),v=l(4552);class C extends t.x{constructor(c=1/0,a=1/0,r=v.l){super(),this._bufferSize=c,this._windowTime=a,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=a===1/0,this._bufferSize=Math.max(1,c),this._windowTime=Math.max(1,a)}next(c){const{isStopped:a,_buffer:r,_infiniteTimeWindow:u,_timestampProvider:f,_windowTime:_}=this;a||(r.push(c),!u&&r.push(f.now()+_)),this._trimBuffer(),super.next(c)}_subscribe(c){this._throwIfClosed(),this._trimBuffer();const a=this._innerSubscribe(c),{_infiniteTimeWindow:r,_buffer:u}=this,f=u.slice();for(let _=0;_<f.length&&!c.closed;_+=r?1:2)c.next(f[_]);return this._checkFinalizedStatuses(c),a}_trimBuffer(){const{_bufferSize:c,_timestampProvider:a,_buffer:r,_infiniteTimeWindow:u}=this,f=(u?1:2)*c;if(c<1/0&&f<r.length&&r.splice(0,r.length-f),!u){const _=a.now();let A=0;for(let b=1;b<r.length&&r[b]<=_;b+=2)A=b;A&&r.splice(0,A+1)}}}var S=l(3020);function Z(d,c,a){let r,u=!1;return d&&"object"==typeof d?({bufferSize:r=1/0,windowTime:c=1/0,refCount:u=!1,scheduler:a}=d):r=d??1/0,(0,S.B)({connector:()=>new C(r,c,a),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:u})}var T=l(5879);let x=(()=>{class d{constructor(a){this.httpClient=a,this.options={headers:(new m.WM).set("Content-Type","application/json")}}private(){return`${location.protocol}//${location.hostname+(location.port?":"+location.port:"")}/`}get(a,r=new m.LE){return(0,g.x)(),this.httpClient.get(a,{params:r}).pipe((0,i.U)(u=>u.result),Z())}put(a,r={}){return(0,g.x)(),this.httpClient.put(a,r).pipe((0,i.U)(u=>u.result))}post(a,r={}){return(0,g.x)(),this.httpClient.post(a,r).pipe((0,i.U)(u=>u.result))}delete(a){return(0,g.x)(),this.httpClient.delete(a).pipe((0,i.U)(r=>r.result),Z())}getFile(a,r=new m.LE){return this.httpClient.get(a,{responseType:"blob",headers:(new m.WM).append("Content-Type","application/json")})}getIp(){return(0,g.x)(),this.httpClient.get("https://ipapi.co/json/").pipe(Z())}static#t=this.\u0275fac=function(r){return new(r||d)(T.LFG(m.eN))};static#e=this.\u0275prov=T.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"})}return d})()},6480:(q,U,l)=>{l.r(U),l.d(U,{CouponModule:()=>D});var m=l(6814),g=l(1076),i=l(95),t=l(5879),v=l(7285),C=l(7398),S=l(4495);let Z=(()=>{class s{constructor(e){this.http=e,this.routes={createPath:"coupon/create",getAllPath:"coupon/getAll",getAllMasterDataPath:"coupon/getAllMasterData",updatePath:n=>`coupon/update/${n}`,getByIdPath:n=>`coupon/getById/${n}`,deletePath:n=>`coupon/delete/${n}`}}create(e){return this.http.post(this.routes.createPath,e).pipe((0,C.U)(n=>n))}getAll(e){return this.http.get(this.routes.getAllPath,e).pipe((0,C.U)(n=>n))}getAllMasterData(e){return this.http.get(this.routes.getAllMasterDataPath,e).pipe((0,C.U)(n=>n))}update(e,n){return this.http.put(this.routes.updatePath(e),n).pipe((0,C.U)(o=>o))}getById(e){return this.http.get(this.routes.getByIdPath(e)).pipe((0,C.U)(n=>n))}delete(e){return this.http.delete(this.routes.deletePath(e)).pipe((0,C.U)(n=>n))}static#t=this.\u0275fac=function(n){return new(n||s)(t.LFG(S.s))};static#e=this.\u0275prov=t.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})();var T=l(4087),x=l(485),d=l(7741);function c(s,y){if(1&s&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&s){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",null==e?null:e.discountPercentage,"% ")}}function a(s,y){if(1&s&&(t._uU(0),t.ALo(1,"currency")),2&s){const e=t.oxw().$implicit;t.hij(" ",t.xi3(1,1,null==e?null:e.discountAmount,"INR")," ")}}function r(s,y){if(1&s){const e=t.EpF();t.TgZ(0,"tr")(1,"td",26),t._uU(2),t.qZA(),t.TgZ(3,"td",26),t._uU(4),t.qZA(),t.TgZ(5,"td",26),t._uU(6),t.qZA(),t.TgZ(7,"td",26),t._uU(8),t.ALo(9,"date"),t.qZA(),t.TgZ(10,"td",26),t.YNc(11,c,2,1,"span",27),t.YNc(12,a,2,4,"ng-template",null,28,t.W1O),t.qZA(),t.TgZ(14,"td",26)(15,"span"),t._uU(16),t.ALo(17,"titlecase"),t.qZA()(),t.TgZ(18,"td",29),t.ynx(19),t.TgZ(20,"button",30),t.NdJ("click",function(){const p=t.CHM(e).$implicit,h=t.oxw();return t.KtG(h.navigateTo("/default/coupon/coupon-form",null==p?null:p._id))}),t._UZ(21,"i",31),t.qZA(),t.TgZ(22,"button",32),t.NdJ("click",function(){const p=t.CHM(e).$implicit,h=t.oxw(),I=t.MAs(41);return t.KtG(h.open(p,I))}),t._UZ(23,"i",33),t.qZA(),t.BQk(),t.qZA()()}if(2&s){const e=y.$implicit,n=y.index,o=t.MAs(13);t.xp6(2),t.Oqu(n+1),t.xp6(2),t.Oqu(null==e?null:e.couponCode),t.xp6(2),t.Oqu(null==e?null:e.description),t.xp6(2),t.Oqu(t.lcZ(9,10,null==e?null:e.expirationDate)),t.xp6(3),t.Q6J("ngIf",null==e?null:e.discountPercentage)("ngIfElse",o),t.xp6(4),t.Gre("badge rounded-pill  text-bg-","active"==e.status?"success":"danger"," px-2"),t.xp6(1),t.hij(" ",t.lcZ(17,12,e.status),"")}}function u(s,y){if(1&s){const e=t.EpF();t.TgZ(0,"div",34)(1,"button",35),t.NdJ("click",function(){const p=t.CHM(e).$implicit;return t.KtG(p.dismiss("Cross click"))}),t.qZA()(),t.TgZ(2,"div",36)(3,"h2",37),t._uU(4),t.qZA(),t.TgZ(5,"h4",38),t._uU(6," Are you sure you want to Delete ? "),t.qZA()(),t.TgZ(7,"div",39)(8,"button",40),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.delete(null==o.selectedRow?null:o.selectedRow._id))}),t._uU(9," YES "),t.qZA(),t.TgZ(10,"button",41),t.NdJ("click",function(){const p=t.CHM(e).$implicit;return t.KtG(p.dismiss("Cross click"))}),t._uU(11," NO "),t.qZA()()}if(2&s){const e=t.oxw();t.xp6(4),t.hij(" ",null==e.selectedRow?null:e.selectedRow.couponCode," ")}}let f=(()=>{class s{constructor(e,n,o,p){this.router=e,this.couponService=n,this.spinner=o,this.toastService=p,this.modalService=(0,t.f3M)(v.FF),this.page=1,this.pageSize=25,this.collection=0,this.column="createdAt",this.direction=-1,this.search="",this.coupon=[],this.address=""}ngOnInit(){this.getAll()}navigateTo(e,n){n?this.router.navigate([e],{queryParams:{id:n}}):this.router.navigate([e])}open(e,n){this.selectedRow=e,this.modalService.open(n,{centered:!0})}searchFn(){(this.search.toString().length>=3||0==this.search.toString().length)&&this.getAll()}delete(e){this.spinner.show(),this.couponService.delete(e).subscribe(n=>{this.spinner.hide(),this.toastService.success(n.message),this.modalService.dismissAll(),this.getAll()})}onChangePage(e){e>0&&(this.page=e),this.getAll()}getAll(){this.spinner.show(),this.couponService.getAll({page:this.page,pageSize:this.pageSize,search:this.search}).subscribe(n=>{this.spinner.hide(),this.coupon=n.rows,this.collection=n.count})}static#t=this.\u0275fac=function(n){return new(n||s)(t.Y36(g.F0),t.Y36(Z),t.Y36(T.V),t.Y36(x.k))};static#e=this.\u0275cmp=t.Xpm({type:s,selectors:[["app-coupon-list"]],decls:42,vars:5,consts:[[1,"table-container"],[1,"card","table-card"],[1,"card-title"],[1,"card-header"],[1,"row","justify-content-between"],[1,"col-4"],[1,"input-icons"],[1,"input-group","input-group-sm"],["type","search","aria-label","Small","placeholder","Search","aria-describedby","inputGroup-sizing-sm",1,"form-control",3,"ngModel","ngModelChange","input"],[1,"input-group-append"],["id","inputGroup-sizing-sm",1,"input-group-text","h-100"],[1,"ti","ti-search"],[1,"col-md-4","col-3","text-right"],[1,"btn","add-btn",3,"click"],[1,"ti","ti-plus","me-1"],[1,"card-body","p-3"],[1,"table-responsive"],[1,"table","table-hover","table-bordered"],[1,"thead"],[1,"table-secondary"],["scope","col"],["scope","col",1,"mx-auto","text-center"],[1,"tbody","mt-3"],[4,"ngFor","ngForOf"],[3,"page","pageSize","collection","pageChange","pageSizeChange","collectionChange","myOutput"],["deleteModal",""],["scope","row"],[4,"ngIf","ngIfElse"],["elseBlock",""],["scope","row",1,"text-center"],["ngbTooltip","Update",1,"btn","action-btn","btn-sm","mx-2",3,"click"],[1,"ti","ti-edit-circle"],["ngbTooltip","Delete",1,"btn","action-btn","btn-sm",3,"click"],[1,"ti","ti-trash"],[1,"modal-header","border-0"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body","border-0"],["id","modal-basic-title",1,"modal-title","text-center","text-primary"],["id","modal-basic-title",1,"modal-title","text-center"],[1,"modal-footer","justify-content-center","border-0"],["type","button",1,"btn","px-4","btn-danger",3,"click"],["type","button",1,"btn","px-4","btn-primary",3,"click"]],template:function(n,o){1&n&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3"),t._uU(4,"Coupon List"),t.qZA()(),t.TgZ(5,"div",3)(6,"div",4)(7,"div",5)(8,"div",6)(9,"div",7)(10,"input",8),t.NdJ("ngModelChange",function(h){return o.search=h})("input",function(){return o.searchFn()}),t.qZA(),t.TgZ(11,"div",9)(12,"span",10),t._UZ(13,"i",11),t.qZA()()()()(),t.TgZ(14,"div",12)(15,"button",13),t.NdJ("click",function(){return o.navigateTo("/default/coupon/coupon-form",null)}),t._UZ(16,"i",14),t._uU(17," Add Coupon "),t.qZA()()()(),t.TgZ(18,"div",15)(19,"div",16)(20,"table",17)(21,"thead",18)(22,"tr",19)(23,"th",20),t._uU(24,"Sr. No."),t.qZA(),t.TgZ(25,"th",20),t._uU(26,"Coupon Code"),t.qZA(),t.TgZ(27,"th",20),t._uU(28,"Description"),t.qZA(),t.TgZ(29,"th",20),t._uU(30,"Expiration Date"),t.qZA(),t.TgZ(31,"th",20),t._uU(32,"Discount"),t.qZA(),t.TgZ(33,"th",20),t._uU(34,"Status"),t.qZA(),t.TgZ(35,"th",21),t._uU(36,"Action"),t.qZA()()(),t.TgZ(37,"tbody",22),t.YNc(38,r,24,14,"tr",23),t.qZA()()(),t.TgZ(39,"app-custom-pagination",24),t.NdJ("pageChange",function(h){return o.page=h})("pageSizeChange",function(h){return o.pageSize=h})("collectionChange",function(h){return o.collection=h})("myOutput",function(){return o.onChangePage(o.page)}),t.qZA()()()(),t.YNc(40,u,12,1,"ng-template",null,25,t.W1O)),2&n&&(t.xp6(10),t.Q6J("ngModel",o.search),t.xp6(28),t.Q6J("ngForOf",o.coupon),t.xp6(1),t.Q6J("page",o.page)("pageSize",o.pageSize)("collection",o.collection))},dependencies:[m.sg,m.O5,v._L,i.Fj,i.JJ,i.On,d.W,m.rS,m.H9,m.uU],encapsulation:2})}return s})();var _=l(9769),A=l(2096),b=l(6857);let F=(()=>{class s{constructor(e,n,o,p,h,I,M,k){this.formBuilder=e,this.router=n,this.spinner=o,this.validationService=p,this.activated=h,this.couponService=I,this.toastService=M,this.modelService=k,this.submitted=!1,this.userId=null,this.today=(new Date).toISOString().split("T")[0],this.couponForm=new i.cw({_id:new i.NI(null),couponCode:new i.NI(null,[i.kI.required]),description:new i.NI(null,[i.kI.required]),discountPercentage:new i.NI(null),discountAmount:new i.NI(null),expirationDate:new i.NI(null,[i.kI.required]),status:new i.NI("active")}),this.FORM_ERRORS=[{message:"Coupon Code is Required",key:"couponCode"},{message:"Description is Required",key:"description"},{message:"Expiration Date is Required",key:"expirationDate"}]}get f(){return this.couponForm.controls}ngOnInit(){this.getInitialData()}navigateTo(e){this.router.navigate([e])}submit(){if(this.submitted=!0,this.validationService.checkErrors(this.couponForm,this.FORM_ERRORS))return;let e=this.couponForm.value;e._id?(delete e.password,this.update(e)):(delete e._id,this.create(e))}create(e){this.spinner.show(),this.couponService.create(e).subscribe(n=>{this.spinner.hide(),this.toastService.success(n.message),this.router.navigate(["default/coupon/coupon-list"])})}update(e){this.spinner.show(),this.couponService.update(e._id,e).subscribe(n=>{this.spinner.hide(),this.toastService.success(n.message),this.router.navigate(["/default/coupon/coupon-list"])})}reset(){this.couponForm.reset(),this.getInitialData()}getInitialData(){this.couponService.getAllMasterData({}).subscribe(e=>{this.f.couponCode.setValue(e.couponCode),this.activated.queryParams.pipe((0,_.z)(n=>n.id?this.couponService.getById(n.id):(0,A.of)({}))).subscribe(n=>{n.expirationDate&&(n.expirationDate=n.expirationDate.split("T")[0]),this.couponForm.patchValue(n)})})}static#t=this.\u0275fac=function(n){return new(n||s)(t.Y36(i.qu),t.Y36(g.F0),t.Y36(T.V),t.Y36(b.R),t.Y36(g.gz),t.Y36(Z),t.Y36(x.k),t.Y36(v.FF))};static#e=this.\u0275cmp=t.Xpm({type:s,selectors:[["app-coupon-form"]],decls:60,vars:9,consts:[[1,"card","form-card"],[1,"card-header"],[1,"card-header-items"],[1,"ms-2"],[1,"back-btn","btn","btn-primary",3,"click"],[1,"ti","ti-arrow-left","me-1"],[1,"card-body"],[3,"formGroup"],[1,"row"],[1,"col-md-6","mb-2"],[1,"form-label"],[1,"text-danger"],["formControlName","couponCode","placeholder","Coupon Code","type","text","readonly","",1,"form-control"],["formControlName","description","placeholder","Description","type","text",1,"form-control"],["formControlName","expirationDate","placeholder","Expiration Date","type","date",1,"form-control",3,"min"],[1,"col-md-6"],["formControlName","status",1,"form-control"],["selected","","disabled","",3,"value"],["value","active"],["value","inactive"],["formControlName","discountPercentage","placeholder","Discount Percentage","type","number","min","0","max","100",1,"form-control"],["formControlName","discountAmount","placeholder","Discount Amount","type","number",1,"form-control"],[1,"my-3"],[1,"col-12"],[1,"d-flex","justify-content-center"],["type","submit",1,"btn","reset-btn","btn-primary",3,"click"],[1,"fa-solid","fa-arrows-rotate","me-2"],["type","submit",1,"btn","submit-btn",3,"click"],[1,"fa-solid","me-2"]],template:function(n,o){1&n&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),t._uU(4),t.qZA(),t.TgZ(5,"div")(6,"a",4),t.NdJ("click",function(){return o.navigateTo("/default/coupon/coupon-list")}),t._UZ(7,"i",5),t._uU(8," Back"),t.qZA()()()(),t.TgZ(9,"div",6)(10,"form",7)(11,"div",8)(12,"div",9)(13,"label",10),t._uU(14," Coupon Code "),t.TgZ(15,"span",11),t._uU(16,"*"),t.qZA()(),t._UZ(17,"input",12)(18,"div"),t.qZA(),t.TgZ(19,"div",9)(20,"label",10),t._uU(21," Description "),t.TgZ(22,"span",11),t._uU(23,"*"),t.qZA()(),t._UZ(24,"input",13),t.qZA()(),t.TgZ(25,"div",8)(26,"div",9)(27,"label",10),t._uU(28," Expiration Date "),t.qZA(),t._UZ(29,"input",14),t.qZA(),t.TgZ(30,"div",15)(31,"label",10),t._uU(32," Status "),t.TgZ(33,"span",11),t._uU(34,"*"),t.qZA()(),t.TgZ(35,"select",16)(36,"option",17),t._uU(37,"Select Status"),t.qZA(),t.TgZ(38,"option",18),t._uU(39,"Active"),t.qZA(),t.TgZ(40,"option",19),t._uU(41,"InActive"),t.qZA()()(),t.TgZ(42,"div",9)(43,"label",10),t._uU(44," Discount Percentage "),t.qZA(),t._UZ(45,"input",20),t.qZA(),t.TgZ(46,"div",15)(47,"label",10),t._uU(48," Discount Amount "),t.qZA(),t._UZ(49,"input",21),t.qZA()(),t._UZ(50,"hr",22),t.TgZ(51,"div",8)(52,"div",23)(53,"div",24)(54,"button",25),t.NdJ("click",function(){return o.reset()}),t._UZ(55,"i",26),t._uU(56," Reset "),t.qZA(),t.TgZ(57,"button",27),t.NdJ("click",function(){return o.submit()}),t._UZ(58,"i",28),t._uU(59),t.qZA()()()()()()()),2&n&&(t.xp6(4),t.hij("",o.userId?"Update":"Create"," Coupon"),t.xp6(6),t.Q6J("formGroup",o.couponForm),t.xp6(19),t.Q6J("min",o.today),t.xp6(7),t.Q6J("value",null),t.xp6(21),t.Tol(o.userId?"btn-warning":"btn-success"),t.xp6(1),t.Tol(o.userId?"fa-pen-to-square":"fa-plus"),t.xp6(1),t.hij(" ",o.userId?"Update":"Create"," "))},dependencies:[i._Y,i.YN,i.Kr,i.Fj,i.wV,i.EJ,i.JJ,i.JL,i.qQ,i.Fd,i.sg,i.u],encapsulation:2})}return s})();var w=l(8672);const N=[{path:"",redirectTo:"coupon-list",pathMatch:"full"},{path:"coupon-list",component:f},{path:"coupon-form",component:F}];let D=(()=>{class s{static#t=this.\u0275fac=function(n){return new(n||s)};static#e=this.\u0275mod=t.oAB({type:s});static#n=this.\u0275inj=t.cJS({imports:[m.ez,v.HK,w.ef,g.Bz.forChild(N),i.u5,i.UX,d.W]})}return s})()}}]);