"use strict";(self.webpackChunkmantis_free_version=self.webpackChunkmantis_free_version||[]).push([[597],{4495:(x,C,s)=>{s.d(C,{s:()=>l});var h=s(9862),g=s(3997),t=s(7398),T=s(8645),U=s(4552);class O extends T.x{constructor(p=1/0,a=1/0,o=U.l){super(),this._bufferSize=p,this._windowTime=a,this._timestampProvider=o,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=a===1/0,this._bufferSize=Math.max(1,p),this._windowTime=Math.max(1,a)}next(p){const{isStopped:a,_buffer:o,_infiniteTimeWindow:u,_timestampProvider:v,_windowTime:f}=this;a||(o.push(p),!u&&o.push(v.now()+f)),this._trimBuffer(),super.next(p)}_subscribe(p){this._throwIfClosed(),this._trimBuffer();const a=this._innerSubscribe(p),{_infiniteTimeWindow:o,_buffer:u}=this,v=u.slice();for(let f=0;f<v.length&&!p.closed;f+=o?1:2)p.next(v[f]);return this._checkFinalizedStatuses(p),a}_trimBuffer(){const{_bufferSize:p,_timestampProvider:a,_buffer:o,_infiniteTimeWindow:u}=this,v=(u?1:2)*p;if(p<1/0&&v<o.length&&o.splice(0,o.length-v),!u){const f=a.now();let y=0;for(let b=1;b<o.length&&o[b]<=f;b+=2)y=b;y&&o.splice(0,y+1)}}}var w=s(3020);function Z(c,p,a){let o,u=!1;return c&&"object"==typeof c?({bufferSize:o=1/0,windowTime:p=1/0,refCount:u=!1,scheduler:a}=c):o=c??1/0,(0,w.B)({connector:()=>new O(o,p,a),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:u})}var A=s(5879);let l=(()=>{class c{constructor(a){this.httpClient=a,this.options={headers:(new h.WM).set("Content-Type","application/json")}}private(){return`${location.protocol}//${location.hostname+(location.port?":"+location.port:"")}/`}get(a,o=new h.LE){return(0,g.x)(),this.httpClient.get(a,{params:o}).pipe((0,t.U)(u=>u.result),Z())}put(a,o={}){return(0,g.x)(),this.httpClient.put(a,o).pipe((0,t.U)(u=>u.result))}post(a,o={}){return(0,g.x)(),this.httpClient.post(a,o).pipe((0,t.U)(u=>u.result))}delete(a){return(0,g.x)(),this.httpClient.delete(a).pipe((0,t.U)(o=>o.result),Z())}getFile(a,o=new h.LE){return this.httpClient.get(a,{responseType:"blob",headers:(new h.WM).append("Content-Type","application/json")})}getIp(){return(0,g.x)(),this.httpClient.get("https://ipapi.co/json/").pipe(Z())}static#t=this.\u0275fac=function(o){return new(o||c)(A.LFG(h.eN))};static#e=this.\u0275prov=A.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})()},8597:(x,C,s)=>{s.r(C),s.d(C,{OrderModule:()=>N});var h=s(6814),g=s(1076),t=s(5879),T=s(7285),U=s(7398),O=s(4495);let w=(()=>{class r{constructor(e){this.http=e,this.routes={getAllPath:"order",getByIdPath:n=>`order/${n}`,updatePath:n=>`order/${n}`}}getAll(e){return this.http.get(this.routes.getAllPath,e)}getById(e){return this.http.get(this.routes.getByIdPath(e)).pipe((0,U.U)(n=>n))}update(e,n){return this.http.put(this.routes.updatePath(e),n).pipe((0,U.U)(i=>i))}static#t=this.\u0275fac=function(n){return new(n||r)(t.LFG(O.s))};static#e=this.\u0275prov=t.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();var Z=s(4087),A=s(2425),l=s(95),c=s(7741);function p(r,_){if(1&r){const e=t.EpF();t.TgZ(0,"tr")(1,"td",25),t._uU(2),t.qZA(),t.TgZ(3,"td",26),t._uU(4),t.qZA(),t.TgZ(5,"td",27),t._uU(6),t.qZA(),t.TgZ(7,"td",25),t._uU(8),t.ALo(9,"currency"),t.qZA(),t.TgZ(10,"td",28),t._uU(11),t.qZA(),t.TgZ(12,"td",26),t._uU(13),t.ALo(14,"date"),t.qZA(),t.TgZ(15,"td",26)(16,"button",29),t.NdJ("click",function(){const d=t.CHM(e).$implicit,m=t.oxw();return t.KtG(m.navigateTo("/default/order/order-view",d.id))}),t._UZ(17,"i",30),t.qZA()()()}if(2&r){const e=_.$implicit,n=_.index,i=t.oxw();t.xp6(2),t.Oqu(i.pageSize*(i.page-1)+(n+1)),t.xp6(2),t.hij(" ",null==e?null:e.orderNumber," "),t.xp6(2),t.hij(" ",(null==e?null:e.address.location)+","+(null==e?null:e.address.city)+","+(null==e?null:e.address.state)+","+(null==e?null:e.address.country)+","+(null==e?null:e.address.pinCode)," "),t.xp6(2),t.hij(" ",t.xi3(9,6,(null==e||null==e.orderWithOrderVariantMap[0]?null:e.orderWithOrderVariantMap[0].price)*(null==e||null==e.orderWithOrderVariantMap[0]?null:e.orderWithOrderVariantMap[0].qty),"INR")," "),t.xp6(3),t.Oqu(null==e?null:e.status),t.xp6(2),t.hij(" ",t.lcZ(14,9,null==e?null:e.createdAt)," ")}}function a(r,_){if(1&r){const e=t.EpF();t.TgZ(0,"div",31)(1,"button",32),t.NdJ("click",function(){const d=t.CHM(e).$implicit;return t.KtG(d.dismiss("Cross click"))}),t.qZA()(),t.TgZ(2,"div",33)(3,"h3",34),t._uU(4),t.ALo(5,"uppercase"),t.qZA(),t.TgZ(6,"h4",35),t._uU(7," Are you sure you want to Delete ? "),t.qZA()(),t.TgZ(8,"div",36)(9,"button",37),t._uU(10,"YES"),t.qZA(),t.TgZ(11,"button",38),t.NdJ("click",function(){const d=t.CHM(e).$implicit;return t.KtG(d.dismiss("Cross click"))}),t._uU(12," NO "),t.qZA()()}if(2&r){const e=t.oxw();t.xp6(4),t.AsE(" ",e.selectedRow.code," - ",t.lcZ(5,2,e.selectedRow.name)," ")}}let o=(()=>{class r{constructor(e,n,i,d){this.router=e,this.orderService=n,this.spinner=i,this.toastService=d,this.page=1,this.pageSize=10,this.collection=0,this.column="createdAt",this.direction=-1,this.search="",this.data=[],this.modalService=(0,t.f3M)(T.FF)}updateUser(e){}ngOnInit(){this.getAll()}onChangePage(e){e>0&&(this.page=e),this.getAll()}searchFn(){(this.search.toString().length>=1||0==this.search.toString().length)&&this.getAll()}open(e,n){this.selectedRow=e,this.modalService.open(n,{centered:!0})}navigateTo(e,n){n?this.router.navigate([e],{queryParams:{id:n}}):this.router.navigate([e])}getAll(){this.spinner.show(),this.orderService.getAll({page:this.page,pageSize:this.pageSize,search:this.search}).subscribe(n=>{this.spinner.hide(),this.data=n,this.collection=n.count})}static#t=this.\u0275fac=function(n){return new(n||r)(t.Y36(g.F0),t.Y36(w),t.Y36(Z.V),t.Y36(A._W))};static#e=this.\u0275cmp=t.Xpm({type:r,selectors:[["app-order-list"]],decls:40,vars:5,consts:[[1,"table-container"],[1,"card","table-card"],[1,"card-title"],[1,"row"],[1,"col"],[1,"card-header"],[1,"row","justify-content-between"],[1,"col-4"],[1,"input-icons"],[1,"input-group","input-group-sm"],["type","search","aria-label","Small","placeholder","Search","aria-describedby","inputGroup-sizing-sm",1,"form-control",3,"ngModel","ngModelChange","input"],[1,"input-group-append"],["id","inputGroup-sizing-sm",1,"input-group-text","h-100"],[1,"ti","ti-search"],[1,"card-body","p-3"],[1,"table-responsive"],[1,"table","table-hover","table-bordered"],[1,"thead"],[1,"table-secondary"],["scope","col",1,"text-start"],["scope","col"],[1,"tbody","mt-3"],[4,"ngFor","ngForOf"],[3,"page","pageSize","collection","pageChange","pageSizeChange","collectionChange","myOutput"],["deleteModal",""],["scope","row"],["scope","row",1,"text-center"],["scope","row",1,"text-start"],["scope","row",1,"text-center","text-capitalize"],["ngbTooltip","Summary",1,"btn","action-btn","btn-sm","mx-2",3,"click"],[1,"ti","ti-edit-circle"],[1,"modal-header","border-0"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body","border-0"],["id","modal-basic-title",1,"modal-title","text-center","text-primary"],["id","modal-basic-title",1,"modal-title","text-center"],[1,"modal-footer","justify-content-center","border-0"],[1,"btn","px-4","btn-outline-danger"],["type","button",1,"btn","px-4","btn-outline-primary",3,"click"]],template:function(n,i){1&n&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h3"),t._uU(6,"Order List"),t.qZA()()()(),t.TgZ(7,"div",5)(8,"div",6)(9,"div",7)(10,"div",8)(11,"div",9)(12,"input",10),t.NdJ("ngModelChange",function(m){return i.search=m})("input",function(){return i.searchFn()}),t.qZA(),t.TgZ(13,"div",11)(14,"span",12),t._UZ(15,"i",13),t.qZA()()()()()()(),t.TgZ(16,"div",14)(17,"div",15)(18,"table",16)(19,"thead",17)(20,"tr",18)(21,"th",19),t._uU(22,"#"),t.qZA(),t.TgZ(23,"th",20),t._uU(24,"Order ID"),t.qZA(),t.TgZ(25,"th",20),t._uU(26,"Billing Address"),t.qZA(),t.TgZ(27,"th",20),t._uU(28,"Amount"),t.qZA(),t.TgZ(29,"th",20),t._uU(30,"Status"),t.qZA(),t.TgZ(31,"th",20),t._uU(32,"Purchase Date"),t.qZA(),t.TgZ(33,"th",20),t._uU(34,"Action"),t.qZA()()(),t.TgZ(35,"tbody",21),t.YNc(36,p,18,11,"tr",22),t.qZA()()(),t.TgZ(37,"app-custom-pagination",23),t.NdJ("pageChange",function(m){return i.page=m})("pageSizeChange",function(m){return i.pageSize=m})("collectionChange",function(m){return i.collection=m})("myOutput",function(){return i.onChangePage(i.page)}),t.qZA()()()(),t.YNc(38,a,13,4,"ng-template",null,24,t.W1O)),2&n&&(t.xp6(12),t.Q6J("ngModel",i.search),t.xp6(24),t.Q6J("ngForOf",i.data),t.xp6(1),t.Q6J("page",i.page)("pageSize",i.pageSize)("collection",i.collection))},dependencies:[h.sg,l.Fj,l.JJ,l.On,c.W,T._L,h.gd,h.H9,h.uU]})}return r})();var u=s(485);function v(r,_){if(1&r&&(t.ynx(0),t._uU(1),t._UZ(2,"i",45),t.BQk()),2&r){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",e.AttrVariantMapWithAttributes.name+" | "," "),t.xp6(1),t.Udp("color",e.value)}}function f(r,_){if(1&r&&(t.ynx(0),t._uU(1),t.BQk()),2&r){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",e.AttrVariantMapWithAttributes.name+" | "+e.value," ")}}function y(r,_){if(1&r&&(t.TgZ(0,"p"),t.YNc(1,v,3,3,"ng-container",44),t.YNc(2,f,2,1,"ng-container",44),t.qZA()),2&r){const e=_.$implicit;t.xp6(1),t.Q6J("ngIf","color"==e.AttrVariantMapWithAttributes.name),t.xp6(1),t.Q6J("ngIf","color"!=e.AttrVariantMapWithAttributes.name)}}function b(r,_){if(1&r&&(t.TgZ(0,"div",38)(1,"div",39),t._UZ(2,"img",40),t.TgZ(3,"div",41)(4,"p"),t._uU(5),t.qZA(),t.TgZ(6,"p"),t._uU(7),t.ALo(8,"currency"),t.qZA()()(),t.TgZ(9,"div",42)(10,"span"),t._uU(11,"Product Properties:"),t.qZA(),t.YNc(12,y,3,2,"p",43),t.qZA()()),2&r){const e=_.$implicit;t.xp6(2),t.Q6J("src",e.orderVariantMapWithVariant.variantImages[0].image,t.LSH),t.xp6(3),t.Oqu(e.orderVariantMapWithVariant.sku),t.xp6(2),t.AsE(" ",t.xi3(8,5,e.orderVariantMapWithVariant.price,"INR")," X ",e.qty," "),t.xp6(5),t.Q6J("ngForOf",e.orderVariantMapWithVariant.variantWithAttrVariantMap)}}let F=(()=>{class r{constructor(e,n,i,d,m){this.router=e,this.activated=n,this.orderService=i,this.spinner=d,this.toastService=m,this.id=null,this.data={},this.subtotal=0,this.orderForm=new l.cw({total:new l.NI(0),discount:new l.NI(null),shippingFee:new l.NI(null),status:new l.NI("approved",[l.kI.required])})}ngOnInit(){this.activated.queryParams.subscribe(e=>{this.id=Number(e?.id)}),this.getData()}navigateTo(e){this.router.navigate([e])}getData(){this.spinner.show();try{this.orderService.getById(this.id).subscribe(e=>{this.spinner.hide(),this.data=e,this.orderForm.patchValue(e),console.log("this.subtotal11",this.subtotal),this.subtotal=this.data.orderWithOrderVariantMap.map(n=>n.price).reduce((n,i)=>n+i,0)})}catch(e){console.log("error",e)}}submit(){this.spinner.show(),this.orderService.update(this.id,this.orderForm.value).subscribe(e=>{this.spinner.hide(),this.toastService.success(e?.message),this.getData()})}totalChange(){let e=this.subtotal;this.orderForm.value.discount&&(e=this.subtotal-this.orderForm.value.discount/100*this.subtotal),this.orderForm.value.shippingFee&&(e+=this.orderForm.value.shippingFee),this.orderForm.controls.total.setValue(e.toFixed(2))}static#t=this.\u0275fac=function(n){return new(n||r)(t.Y36(g.F0),t.Y36(g.gz),t.Y36(w),t.Y36(Z.V),t.Y36(u.k))};static#e=this.\u0275cmp=t.Xpm({type:r,selectors:[["app-order-view"]],decls:72,vars:9,consts:[[1,"card","form-card"],[1,"card-header"],[1,"card-header-items"],[1,"back-btn","btn","btn-primary",3,"click"],[1,"ti","ti-arrow-left","me-1"],[1,"card-body","justify-content-center"],[1,"row","px-3"],[1,"col-6","border-bottom","pb-3"],[1,"mb-0"],[1,"col-12","py-3"],[1,"text-primary","mb-0"],[1,"col-12","border-bottom","py-3"],["class","row border-bottom py-2",4,"ngFor","ngForOf"],[1,"col-12"],[1,"row","justify-content-between"],[1,"col-5","border-bottom","py-3"],[1,"text-primary"],[1,"col-6","py-3"],[3,"formGroup"],[1,"text-primary","mb-3"],[1,"row","pb-3","justify-content-between"],[1,"col-4","d-flex","align-items-center"],[1,"col-2","p-0","text-center"],[1,"col-2","p-0"],["formControlName","shippingFee","type","number",1,"w-100","border","p-2","rounded",3,"input"],[1,"row","pb-3","border-bottom","justify-content-between"],["formControlName","discount","type","number",1,"w-100","border","p-2","rounded",3,"input"],[1,"row","py-2","justify-content-between"],[1,"col-4","d-flex","align-items-center","fw-bold"],["formControlName","total","readonly","","type","number",1,"w-100","border-0","p-2","rounded"],[1,"row","py-2"],[1,"form-label"],[1,"text-danger"],["formControlName","status",1,"form-control"],["value","approved"],["value","rejected"],["value","dispatched"],["value","delivered"],[1,"row","border-bottom","py-2"],[1,"col-6","d-flex"],["width","60","height","60","alt","",3,"src"],[1,"prod-details","ps-3"],[1,"col-6"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"fa-solid","fa-square"]],template:function(n,i){1&n&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div"),t._uU(4,"Order Details"),t.qZA(),t.TgZ(5,"div")(6,"button",3),t.NdJ("click",function(){return i.navigateTo("default/order/order-list")}),t._UZ(7,"i",4),t._uU(8," Back "),t.qZA()()()(),t.TgZ(9,"div",5)(10,"div",6)(11,"div",7)(12,"h6",8),t._uU(13),t.qZA()(),t.TgZ(14,"div",7)(15,"h6",8),t._uU(16),t.qZA()(),t.TgZ(17,"div",9)(18,"h4",10),t._uU(19,"Products"),t.qZA()(),t.TgZ(20,"div",11),t.YNc(21,b,13,8,"div",12),t.qZA(),t.TgZ(22,"div",13)(23,"div",14)(24,"div",15)(25,"h4",16),t._uU(26,"Shipping Address"),t.qZA(),t.TgZ(27,"p"),t._uU(28),t.qZA()(),t.TgZ(29,"div",17)(30,"form",18)(31,"h5",19),t._uU(32,"Total Summary"),t.qZA(),t.TgZ(33,"div",20)(34,"div",21),t._uU(35,"Subtotal :"),t.qZA(),t.TgZ(36,"div",22),t._uU(37),t.ALo(38,"currency"),t.qZA()(),t.TgZ(39,"div",20)(40,"div",21),t._uU(41,"Shipping fee:"),t.qZA(),t.TgZ(42,"div",23)(43,"input",24),t.NdJ("input",function(){return i.totalChange()}),t.qZA()()(),t.TgZ(44,"div",25)(45,"div",21),t._uU(46,"Discount(%):"),t.qZA(),t.TgZ(47,"div",23)(48,"input",26),t.NdJ("input",function(){return i.totalChange()}),t.qZA()()(),t.TgZ(49,"div",27)(50,"div",28),t._uU(51,"Total"),t.qZA(),t.TgZ(52,"div",22),t._UZ(53,"input",29),t.qZA()(),t.TgZ(54,"div",30)(55,"div",13)(56,"label",31),t._uU(57," Status "),t.TgZ(58,"span",32),t._uU(59,"*"),t.qZA()(),t.TgZ(60,"select",33)(61,"option",34),t._uU(62,"Approved"),t.qZA(),t.TgZ(63,"option",35),t._uU(64,"Rejected"),t.qZA(),t.TgZ(65,"option",36),t._uU(66,"Dispatched"),t.qZA(),t.TgZ(67,"option",37),t._uU(68,"Delivered"),t.qZA()()()(),t.TgZ(69,"div",30)(70,"button",3),t.NdJ("click",function(){return i.submit()}),t._uU(71," Save "),t.qZA()()()()()()()()()),2&n&&(t.xp6(13),t.hij("Order ID : ",null==i.data?null:i.data.orderNumber,""),t.xp6(3),t.hij(" Customer Name : ",(null==i.data||null==i.data.customer?null:i.data.customer.firstName)+" "+(null==i.data||null==i.data.customer?null:i.data.customer.lastName)," "),t.xp6(5),t.Q6J("ngForOf",i.data.orderWithOrderVariantMap),t.xp6(7),t.hij(" ",(null==i.data||null==i.data.address?null:i.data.address.location)+","+(null==i.data||null==i.data.address?null:i.data.address.city)+","+(null==i.data||null==i.data.address?null:i.data.address.state)+","+(null==i.data||null==i.data.address?null:i.data.address.country)+","+(null==i.data||null==i.data.address?null:i.data.address.pinCode)," "),t.xp6(2),t.Q6J("formGroup",i.orderForm),t.xp6(7),t.hij(" ",t.xi3(38,6,i.subtotal,"INR")," "))},dependencies:[h.sg,h.O5,l._Y,l.YN,l.Kr,l.Fj,l.wV,l.EJ,l.JJ,l.JL,l.sg,l.u,h.H9]})}return r})();var q=s(8672);const S=[{path:"",redirectTo:"order-list",pathMatch:"full"},{path:"order-view",component:F},{path:"order-list",component:o}];let N=(()=>{class r{static#t=this.\u0275fac=function(n){return new(n||r)};static#e=this.\u0275mod=t.oAB({type:r});static#i=this.\u0275inj=t.cJS({imports:[h.ez,l.u5,l.UX,A.Rh,q.ef,c.W,T.HK,g.Bz.forChild(S)]})}return r})()}}]);