"use strict";(self.webpackChunkmantis_free_version=self.webpackChunkmantis_free_version||[]).push([[779],{4495:(R,T,r)=>{r.d(T,{s:()=>M});var d=r(9862),t=r(3997),m=r(7398),A=r(8645),y=r(4552);class U extends A.x{constructor(p=1/0,l=1/0,s=y.l){super(),this._bufferSize=p,this._windowTime=l,this._timestampProvider=s,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=l===1/0,this._bufferSize=Math.max(1,p),this._windowTime=Math.max(1,l)}next(p){const{isStopped:l,_buffer:s,_infiniteTimeWindow:u,_timestampProvider:_,_windowTime:f}=this;l||(s.push(p),!u&&s.push(_.now()+f)),this._trimBuffer(),super.next(p)}_subscribe(p){this._throwIfClosed(),this._trimBuffer();const l=this._innerSubscribe(p),{_infiniteTimeWindow:s,_buffer:u}=this,_=u.slice();for(let f=0;f<_.length&&!p.closed;f+=s?1:2)p.next(_[f]);return this._checkFinalizedStatuses(p),l}_trimBuffer(){const{_bufferSize:p,_timestampProvider:l,_buffer:s,_infiniteTimeWindow:u}=this,_=(u?1:2)*p;if(p<1/0&&_<s.length&&s.splice(0,s.length-_),!u){const f=l.now();let Z=0;for(let C=1;C<s.length&&s[C]<=f;C+=2)Z=C;Z&&s.splice(0,Z+1)}}}var b=r(3020);function v(h,p,l){let s,u=!1;return h&&"object"==typeof h?({bufferSize:s=1/0,windowTime:p=1/0,refCount:u=!1,scheduler:l}=h):s=h??1/0,(0,b.B)({connector:()=>new U(s,p,l),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:u})}var g=r(5879);let M=(()=>{class h{constructor(l){this.httpClient=l,this.options={headers:(new d.WM).set("Content-Type","application/json")}}private(){return`${location.protocol}//${location.hostname+(location.port?":"+location.port:"")}/`}get(l,s=new d.LE){return(0,t.x)(),this.httpClient.get(l,{params:s}).pipe((0,m.U)(u=>u.result),v())}put(l,s={}){return(0,t.x)(),this.httpClient.put(l,s).pipe((0,m.U)(u=>u.result))}post(l,s={}){return(0,t.x)(),this.httpClient.post(l,s).pipe((0,m.U)(u=>u.result))}delete(l){return(0,t.x)(),this.httpClient.delete(l).pipe((0,m.U)(s=>s.result),v())}getFile(l,s=new d.LE){return this.httpClient.get(l,{responseType:"blob",headers:(new d.WM).append("Content-Type","application/json")})}getIp(){return(0,t.x)(),this.httpClient.get("https://ipapi.co/json/").pipe(v())}static#t=this.\u0275fac=function(s){return new(s||h)(g.LFG(d.eN))};static#e=this.\u0275prov=g.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"})}return h})()},2118:(R,T,r)=>{r.r(T),r.d(T,{SaleRateModule:()=>D});var d=r(6814),t=r(5879),m=r(1076),A=r(773),y=r(4087),U=r(485),b=r(7741),v=r(4807),g=r(95),M=r(1998);const h=function(){return{standalone:!0}};function p(c,S){if(1&c){const e=t.EpF();t.TgZ(0,"tr")(1,"td",34),t._uU(2),t.qZA(),t.TgZ(3,"td",34),t._uU(4),t.ALo(5,"titlecase"),t.qZA(),t.TgZ(6,"td"),t._uU(7),t.qZA(),t.TgZ(8,"td"),t._uU(9),t.qZA(),t.TgZ(10,"td")(11,"div",27)(12,"input",35),t.NdJ("ngModelChange",function(n){const a=t.CHM(e).$implicit;return t.KtG(a.saleRate=n)})("input",function(){const o=t.CHM(e).$implicit,a=t.oxw();return t.KtG(a.setSalePrice(o))}),t.qZA()()(),t.TgZ(13,"td")(14,"div",27)(15,"input",35),t.NdJ("ngModelChange",function(n){const a=t.CHM(e).$implicit;return t.KtG(a.discount=n)})("input",function(){const o=t.CHM(e).$implicit,a=t.oxw();return t.KtG(a.setSalePrice(o))}),t.qZA()()(),t.TgZ(16,"td"),t._uU(17),t.qZA()()}if(2&c){const e=S.$implicit;t.xp6(2),t.hij(" ",e.label," "),t.xp6(2),t.AsE(" ",e.productCode," - ",t.lcZ(5,10,e.productName)," "),t.xp6(3),t.Oqu(e.quantity),t.xp6(2),t.Oqu(e.purchaseRate),t.xp6(3),t.Q6J("ngModel",e.saleRate)("ngModelOptions",t.DdM(12,h)),t.xp6(3),t.Q6J("ngModel",e.discount)("ngModelOptions",t.DdM(13,h)),t.xp6(2),t.Oqu(e.salePrice)}}let l=(()=>{class c{constructor(e,i,n,o){this.router=e,this.saleRateService=i,this.spinner=n,this.toastService=o,this.page=1,this.pageSize=25,this.collection=0,this.column="createdAt",this.direction=-1,this.submitted=!1,this.isPreview=!1,this.search="",this.allData=[],this.originalData=[],this.batchOptions=[]}ngOnInit(){this.getAllMasterData()}onChangePage(e){e>0&&(this.page=e)}searchFn(){(this.search.toString().length>=3||0==this.search.toString().length)&&this.getAllMasterData()}navigateTo(e){this.router.navigate([e],{state:{products:this.allData.filter(i=>i.quantity>0&&JSON.stringify(i).includes(this.search))}})}getAllMasterData(){this.spinner.show(),this.saleRateService.getAllMasterData({}).subscribe(e=>{this.spinner.hide(),this.allData=e.inventory.map(i=>(i.originalSaleRate=i.saleRate,i.originalDiscount=i.discount,i)),this.originalData=this.allData,this.batchOptions=e.batchOptions,this.collection=this.allData.length})}filterData(e){e.length?(this.allData=this.originalData.filter(i=>e.some(n=>i.inventoryId==n.inventoryId)),this.page=1,this.collection=this.allData.length):(this.allData=this.originalData,this.page=1,this.collection=this.allData.length)}setSalePrice(e){let i=this.allData.map(n=>n._id).indexOf(e._id);this.allData[i].salePrice=Number((+e.saleRate-+e.saleRate*+e.discount/100).toFixed(2))}onSubmit(){this.submitted=!0,this.allData=this.allData.filter(e=>e.salePrice>0&&(e.saleRate!=e.originalSaleRate||e.originalDiscount!=e.discount)),this.page=1,this.collection=this.allData.length,0!=this.allData.length?(this.spinner.show(),this.saleRateService.create(this.allData).subscribe(e=>{this.spinner.hide(),this.toastService.success(e.message),this.getAllMasterData()})):this.toastService.warning("At least One Row is Required")}resetForm(){this.isPreview=!1,this.allData=[],this.collection=this.allData.length,this.getAllMasterData()}preview(){this.search="",this.allData=this.allData.filter(e=>e.salePrice>0),this.allData.length>0?this.isPreview=!0:(this.toastService.warning("At least One Row is Required"),this.isPreview=!1),this.collection=this.allData.length}static#t=this.\u0275fac=function(i){return new(i||c)(t.Y36(m.F0),t.Y36(A.h),t.Y36(y.V),t.Y36(U.k))};static#e=this.\u0275cmp=t.Xpm({type:c,selectors:[["app-list"]],decls:57,vars:16,consts:[[1,"table-container"],[1,"card","table-card"],[1,"card-title"],[1,"card-header"],[1,"row"],[1,"col-4"],["placeholder","Select batch","bindLabel","label","bindValue","inventoryId",1,"ng-select-lg",3,"items","clearable","multiple","change"],[1,"input-icons"],[1,"input-group","input-group-sm"],["type","search","aria-label","Small","placeholder","Search","aria-describedby","inputGroup-sizing-sm",1,"form-control",3,"ngModel","ngModelChange"],[1,"input-group-append"],["id","inputGroup-sizing-sm",1,"input-group-text","h-100"],[1,"ti","ti-search"],[1,"btn","add-btn",3,"click"],[1,"ti","ti-qrcode","me-1"],[1,"card-body","p-3"],[1,"table-responsive"],[1,"table","table-hover","table-bordered","text-center"],[1,"thead"],[1,"table-secondary"],["scope","col",1,"text-start"],["scope","col"],[1,"tbody","mt-3"],[4,"ngFor","ngForOf"],[3,"page","pageSize","collection","pageChange","pageSizeChange","collectionChange","myOutput"],[1,"my-3"],[1,"col-12"],[1,"d-flex","justify-content-center"],["type","submit",1,"btn","reset-btn","px-4","btn-primary",3,"click"],[1,"fa-solid","fa-arrows-rotate","me-2"],["type","submit",1,"btn","reset-btn","px-4","btn-info","mx-4",3,"click"],[1,"fa-solid","fa-eye","me-2"],["type","submit",1,"btn","submit-btn","btn-success","px-4",3,"disabled","click"],[1,"fa-solid","fa-plus","me-2"],[1,"text-start"],["type","number",1,"form-control","form-control-sm","w-50",3,"ngModel","ngModelOptions","ngModelChange","input"]],template:function(i,n){1&i&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3"),t._uU(4,"Sale Rate"),t.qZA()(),t.TgZ(5,"div",3)(6,"div",4)(7,"div",5)(8,"ng-select",6),t.NdJ("change",function(a){return n.filterData(a)}),t.qZA()(),t.TgZ(9,"div",5)(10,"div",7)(11,"div",8)(12,"input",9),t.NdJ("ngModelChange",function(a){return n.search=a}),t.qZA(),t.TgZ(13,"div",10)(14,"span",11),t._UZ(15,"i",12),t.qZA()()()()(),t.TgZ(16,"div",5)(17,"button",13),t.NdJ("click",function(){return n.navigateTo("/default/saleRate/qr-list")}),t._UZ(18,"i",14),t._uU(19," QR Product "),t.qZA()()()(),t.TgZ(20,"div",15)(21,"div",16)(22,"table",17)(23,"thead",18)(24,"tr",19)(25,"th",20),t._uU(26,"Batch (No/Name/Date)"),t.qZA(),t.TgZ(27,"th",20),t._uU(28,"Product( Code - Name)"),t.qZA(),t.TgZ(29,"th",21),t._uU(30,"Quantity"),t.qZA(),t.TgZ(31,"th",21),t._uU(32,"Cost Price"),t.qZA(),t.TgZ(33,"th",21),t._uU(34,"Mark Price"),t.qZA(),t.TgZ(35,"th",21),t._uU(36,"Discount %"),t.qZA(),t.TgZ(37,"th",21),t._uU(38,"Sale Price"),t.qZA()()(),t.TgZ(39,"tbody",22),t.YNc(40,p,18,14,"tr",23),t.ALo(41,"slice"),t.ALo(42,"searchFi1ter"),t.qZA()()(),t.TgZ(43,"app-custom-pagination",24),t.NdJ("pageChange",function(a){return n.page=a})("pageSizeChange",function(a){return n.pageSize=a})("collectionChange",function(a){return n.collection=a})("myOutput",function(){return n.onChangePage(n.page)}),t.qZA(),t._UZ(44,"hr",25),t.TgZ(45,"div",4)(46,"div",26)(47,"div",27)(48,"button",28),t.NdJ("click",function(){return n.resetForm()}),t._UZ(49,"i",29),t._uU(50," Reset "),t.qZA(),t.TgZ(51,"button",30),t.NdJ("click",function(){return n.preview()}),t._UZ(52,"i",31),t._uU(53," Preview "),t.qZA(),t.TgZ(54,"button",32),t.NdJ("click",function(){return n.onSubmit()}),t._UZ(55,"i",33),t._uU(56," Save "),t.qZA()()()()()()()),2&i&&(t.xp6(8),t.Q6J("items",n.batchOptions)("clearable",!0)("multiple",!0),t.xp6(4),t.Q6J("ngModel",n.search),t.xp6(28),t.Q6J("ngForOf",t.Dn7(41,9,t.xi3(42,13,n.allData,n.search),(n.page-1)*n.pageSize,(n.page-1)*n.pageSize+n.pageSize)),t.xp6(3),t.Q6J("page",n.page)("pageSize",n.pageSize)("collection",n.collection),t.xp6(11),t.Q6J("disabled",!n.isPreview))},dependencies:[b.W,d.sg,v.w9,g.Fj,g.wV,g.JJ,g.On,d.OU,d.rS,M.G]})}return c})();var s=r(4086),u=r(7285),_=r(7942),f=r(2425);function Z(c,S){if(1&c&&(t.TgZ(0,"span",37)(1,"strong"),t._uU(2),t.qZA()()),2&c){const e=t.oxw();t.xp6(2),t.hij("Item :- ",e.right,"")}}const C=function(){return{standalone:!0}};function Q(c,S){if(1&c){const e=t.EpF();t.TgZ(0,"tr")(1,"td",38),t._uU(2),t.qZA(),t.TgZ(3,"td",38),t._uU(4),t.qZA(),t.TgZ(5,"td",39)(6,"span",40),t.ALo(7,"titlecase"),t._uU(8),t.ALo(9,"titlecase"),t.qZA()(),t.TgZ(10,"td",41)(11,"div",42)(12,"input",43),t.NdJ("ngModelChange",function(n){const a=t.CHM(e).$implicit;return t.KtG(a.quantity=n)})("input",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.quantityChange())}),t.qZA()()(),t.TgZ(13,"td",41)(14,"div",42)(15,"input",44),t.NdJ("ngModelChange",function(n){const a=t.CHM(e).$implicit;return t.KtG(a.salePrice=n)}),t.qZA()()()()}if(2&c){const e=S.$implicit;t.xp6(2),t.Oqu(e.label),t.xp6(2),t.hij(" ",e.productCode," "),t.xp6(2),t.Q6J("ngbTooltip",t.lcZ(7,8,e.productName)),t.xp6(2),t.hij(" ",t.lcZ(9,10,e.productName),""),t.xp6(4),t.Q6J("ngModel",e.quantity)("ngModelOptions",t.DdM(12,C)),t.xp6(3),t.Q6J("ngModel",e.salePrice)("ngModelOptions",t.DdM(13,C))}}const w=[{path:"",redirectTo:"list",pathMatch:"full"},{path:"list",component:l},{path:"qr-list",component:(()=>{class c{constructor(e,i,n,o,a,q){this.location=e,this.router=i,this.productService=n,this.activated=o,this.spinner=a,this.toastService=q,this.totalQuantity=0,this.page=1,this.pageSize=25,this.collection=0,this.column="createdAt",this.direction=-1,this.search="",this.products=[],this.originProducts=[],this.dropdownItem=[],this.dropdownSelectedItems=[],this.left=0,this.right=0,this.modalService=(0,t.f3M)(u.FF)}ngOnInit(){let e=this.location.getState();this.products=e.products,this.dropdownItem=e.products,this.collection=this.products.length,this.quantityChange()}onChangePage(e){e>0&&(this.page=e)}trackByFn(e,i){return i?._id}open(e,i){this.selectedRow=e,this.modalService.open(i,{centered:!0})}getAll(){this.spinner.show(),this.productService.getAll({}).subscribe(i=>{this.spinner.hide(),this.products=i.products,this.originProducts=i.products,this.collection=i.products.length})}quantityChange(){this.totalQuantity=this.products.reduce((e,i)=>e+i.quantity,0),this.getPageCount()}navigateTo(e){if("/qr-sheet"==e||"/qr-label"==e){let i=this.products.filter(o=>o.quantity>0&&JSON.stringify(o).includes(this.search));i.reduce((o,a)=>o+a.quantity,0),this.router.navigate([e],{state:{products:i.map(o=>{const{productId:a,productCode:q,saleRate:P,quantity:J}=o;return{productId:a,productCode:q,saleRate:P,quantity:J}})}})}else this.router.navigate([e])}back(){this.location.back()}applyFilter(){let e=this.dropdownItem.filter(i=>this.dropdownSelectedItems.length>0?this.dropdownSelectedItems.some(n=>i._id==n):i);this.products=e,this.collection=this.products.length,this.quantityChange()}getPageCount(){if(this.totalQuantity<108)return this.right=0,this.left=1;let e=this.totalQuantity/108;return this.left=Math.floor(e),this.right=Math.round(e%1*100),this.right}static#t=this.\u0275fac=function(i){return new(i||c)(t.Y36(d.S$),t.Y36(m.F0),t.Y36(_.M),t.Y36(m.gz),t.Y36(y.V),t.Y36(f._W))};static#e=this.\u0275cmp=t.Xpm({type:c,selectors:[["app-QRCalculation"]],decls:62,vars:20,consts:[[1,"table-container"],[1,"card","table-card"],[1,"card-title"],[1,"row","justify-content-between"],[1,"col-4"],[1,"d-flex","col-7","justify-content-end"],[1,"btn","btn-danger","align-self-center","me-2",3,"click"],[1,"ti","ti-tag","me-1"],[1,"btn","btn-secondary","align-self-center","me-2",3,"click"],[1,"fa","fa-image","me-1"],[1,"btn","btn-info","align-self-center","me-2",3,"click"],[1,"ti","ti-qrcode","me-1"],[1,"btn","btn-primary",3,"click"],[1,"ti","ti-arrow-left","me-1"],[1,"card-header"],[1,"input-group","input-group-sm"],["bindLabel","productName","bindValue","_id",3,"items","multiple","ngModel","placeholder","ngModelChange","change"],[1,"col-3"],[1,"input-icons"],["type","search","aria-label","Small","placeholder","Search","aria-describedby","inputGroup-sizing-sm",1,"form-control",3,"ngModel","ngModelChange"],[1,"input-group-append"],["id","inputGroup-sizing-sm",1,"input-group-text","h-100"],[1,"ti","ti-search"],[1,"d-flex","col-5","justify-content-end","align-self-center"],[1,"badge","text-bg-primary","mx-2","pt-1"],["class","badge text-bg-info mx-2 pt-1",4,"ngIf"],[1,"badge","text-bg-success","mx-2","pt-1"],[1,"card-body","p-3"],[1,"table-responsive"],[1,"table","table-hover","table-bordered"],[1,"thead"],[1,"table-secondary"],["scope","col"],["scope","col",1,"text-start"],[1,"tbody","mt-3"],[4,"ngFor","ngForOf","ngForTrackBy"],[3,"page","pageSize","collection","pageChange","pageSizeChange","collectionChange","myOutput"],[1,"badge","text-bg-info","mx-2","pt-1"],["scope","row"],["scope","row",1,"text-start"],["placement","top",3,"ngbTooltip"],["scope","row",1,"text-center"],[1,"d-flex","justify-content-center"],["type","number",1,"form-control","form-control-sm","w-50",3,"ngModel","ngModelOptions","ngModelChange","input"],["type","number",1,"form-control","form-control-sm","w-50",3,"ngModel","ngModelOptions","ngModelChange"]],template:function(i,n){1&i&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h3"),t._uU(6,"Product QR"),t.qZA()(),t.TgZ(7,"div",5)(8,"button",6),t.NdJ("click",function(){return n.navigateTo("/qr-label")}),t._UZ(9,"i",7),t._uU(10," Preview Label "),t.qZA(),t.TgZ(11,"button",8),t.NdJ("click",function(){return n.navigateTo("/logoQR")}),t._UZ(12,"i",9),t._uU(13," Preview Logo "),t.qZA(),t.TgZ(14,"button",10),t.NdJ("click",function(){return n.navigateTo("/qr-sheet")}),t._UZ(15,"i",11),t._uU(16," Preview QR "),t.qZA(),t.TgZ(17,"button",12),t.NdJ("click",function(){return n.back()}),t._UZ(18,"i",13),t._uU(19," Back "),t.qZA()()()(),t.TgZ(20,"div",14)(21,"div",3)(22,"div",4)(23,"div",15)(24,"ng-select",16),t.NdJ("ngModelChange",function(a){return n.dropdownSelectedItems=a})("change",function(){return n.applyFilter()}),t.qZA()()(),t.TgZ(25,"div",17)(26,"div",18)(27,"div",15)(28,"input",19),t.NdJ("ngModelChange",function(a){return n.search=a}),t.qZA(),t.TgZ(29,"div",20)(30,"span",21),t._UZ(31,"i",22),t.qZA()()()()(),t.TgZ(32,"div",23),t._uU(33," Page : "),t.TgZ(34,"span",24)(35,"strong"),t._uU(36),t.qZA()(),t.YNc(37,Z,3,1,"span",25),t._uU(38," = "),t.TgZ(39,"span",26)(40,"strong"),t._uU(41),t.qZA()()()()(),t.TgZ(42,"div",27)(43,"div",28)(44,"table",29)(45,"thead",30)(46,"tr",31)(47,"th",32),t._uU(48,"Batch"),t.qZA(),t.TgZ(49,"th",32),t._uU(50,"Product Code"),t.qZA(),t.TgZ(51,"th",33),t._uU(52,"Product Name"),t.qZA(),t.TgZ(53,"th",32),t._uU(54,"Quantity"),t.qZA(),t.TgZ(55,"th",32),t._uU(56,"MRP Cost"),t.qZA()()(),t.TgZ(57,"tbody",34),t.YNc(58,Q,16,14,"tr",35),t.ALo(59,"slice"),t.ALo(60,"searchFi1ter"),t.qZA()()(),t.TgZ(61,"app-custom-pagination",36),t.NdJ("pageChange",function(a){return n.page=a})("pageSizeChange",function(a){return n.pageSize=a})("collectionChange",function(a){return n.collection=a})("myOutput",function(){return n.onChangePage(n.page)}),t.qZA()()()()),2&i&&(t.xp6(24),t.Q6J("items",n.dropdownItem)("multiple",!0)("ngModel",n.dropdownSelectedItems)("placeholder","Select Products"),t.xp6(4),t.Q6J("ngModel",n.search),t.xp6(8),t.Oqu(n.left),t.xp6(1),t.Q6J("ngIf",n.right>0),t.xp6(4),t.Oqu(n.totalQuantity),t.xp6(17),t.Q6J("ngForOf",t.Dn7(59,13,t.xi3(60,17,n.products,n.search),(n.page-1)*n.pageSize,(n.page-1)*n.pageSize+n.pageSize))("ngForTrackBy",n.trackByFn),t.xp6(3),t.Q6J("page",n.page)("pageSize",n.pageSize)("collection",n.collection))},dependencies:[b.W,d.sg,d.O5,v.w9,g.Fj,g.wV,g.JJ,g.On,u._L,d.OU,d.rS,M.G]})}return c})()}];let D=(()=>{class c{static#t=this.\u0275fac=function(i){return new(i||c)};static#e=this.\u0275mod=t.oAB({type:c});static#n=this.\u0275inj=t.cJS({imports:[b.W,d.ez,s.m,m.Bz.forChild(w),g.UX,g.u5]})}return c})()}}]);