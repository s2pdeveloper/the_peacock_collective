"use strict";(self.webpackChunkmantis_free_version=self.webpackChunkmantis_free_version||[]).push([[913],{4495:(S,T,o)=>{o.d(T,{s:()=>l});var g=o(9862),v=o(3997),t=o(7398),b=o(8645),_=o(4552);class U extends b.x{constructor(p=1/0,a=1/0,s=_.l){super(),this._bufferSize=p,this._windowTime=a,this._timestampProvider=s,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=a===1/0,this._bufferSize=Math.max(1,p),this._windowTime=Math.max(1,a)}next(p){const{isStopped:a,_buffer:s,_infiniteTimeWindow:u,_timestampProvider:m,_windowTime:f}=this;a||(s.push(p),!u&&s.push(m.now()+f)),this._trimBuffer(),super.next(p)}_subscribe(p){this._throwIfClosed(),this._trimBuffer();const a=this._innerSubscribe(p),{_infiniteTimeWindow:s,_buffer:u}=this,m=u.slice();for(let f=0;f<m.length&&!p.closed;f+=s?1:2)p.next(m[f]);return this._checkFinalizedStatuses(p),a}_trimBuffer(){const{_bufferSize:p,_timestampProvider:a,_buffer:s,_infiniteTimeWindow:u}=this,m=(u?1:2)*p;if(p<1/0&&m<s.length&&s.splice(0,s.length-m),!u){const f=a.now();let Z=0;for(let y=1;y<s.length&&s[y]<=f;y+=2)Z=y;Z&&s.splice(0,Z+1)}}}var A=o(3020);function C(d,p,a){let s,u=!1;return d&&"object"==typeof d?({bufferSize:s=1/0,windowTime:p=1/0,refCount:u=!1,scheduler:a}=d):s=d??1/0,(0,A.B)({connector:()=>new U(s,p,a),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:u})}var w=o(5879);let l=(()=>{class d{constructor(a){this.httpClient=a,this.options={headers:(new g.WM).set("Content-Type","application/json")}}private(){return`${location.protocol}//${location.hostname+(location.port?":"+location.port:"")}/`}get(a,s=new g.LE){return(0,v.x)(),this.httpClient.get(a,{params:s}).pipe((0,t.U)(u=>u.result),C())}put(a,s={}){return(0,v.x)(),this.httpClient.put(a,s).pipe((0,t.U)(u=>u.result))}post(a,s={}){return(0,v.x)(),this.httpClient.post(a,s).pipe((0,t.U)(u=>u.result))}delete(a){return(0,v.x)(),this.httpClient.delete(a).pipe((0,t.U)(s=>s.result),C())}getFile(a,s=new g.LE){return this.httpClient.get(a,{responseType:"blob",headers:(new g.WM).append("Content-Type","application/json")})}getIp(){return(0,v.x)(),this.httpClient.get("https://ipapi.co/json/").pipe(C())}static#t=this.\u0275fac=function(s){return new(s||d)(w.LFG(g.eN))};static#e=this.\u0275prov=w.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"})}return d})()},8913:(S,T,o)=>{o.r(T),o.d(T,{WastageModule:()=>W});var g=o(6814),v=o(7285),t=o(5879),b=o(1076),_=o(7398),U=o(4495);let A=(()=>{class r{constructor(e){this.http=e,this.routes={createWastage:"wastage/create",getAllPath:"wastage/getAll",updatePath:i=>`wastage/update/${i}`,deletePath:i=>`wastage/delete/${i}`,getByIdPath:i=>`wastage/getById/${i}`,getAllMasterData:"wastage/getAllMasterData"}}createWastage(e){return this.http.post(this.routes.createWastage,e).pipe((0,_.U)(i=>i))}getAllWastage(e){return this.http.get(this.routes.getAllPath,e).pipe((0,_.U)(i=>i))}updateWastageById(e,i){return this.http.put(this.routes.updatePath(e),i).pipe((0,_.U)(n=>n))}deleteWastageById(e){return this.http.delete(this.routes.deletePath(e)).pipe((0,_.U)(i=>i))}getAllMasterData(e){return this.http.get(this.routes.getAllMasterData,e).pipe((0,_.U)(i=>i))}getById(e){return this.http.get(this.routes.getByIdPath(e)).pipe((0,_.U)(i=>i))}static#t=this.\u0275fac=function(i){return new(i||r)(t.LFG(U.s))};static#e=this.\u0275prov=t.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();var C=o(8672),w=o(2425),l=o(95),d=o(7741);function p(r,F){if(1&r){const e=t.EpF();t.TgZ(0,"div",34)(1,"button",35),t.NdJ("click",function(){const c=t.CHM(e).$implicit;return t.KtG(c.dismiss("Cross click"))}),t.qZA()(),t.TgZ(2,"div",36)(3,"h4",37),t._uU(4," Are you sure you want to Delete ? "),t.qZA()(),t.TgZ(5,"div",38)(6,"button",39),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.delete(n.selectedRow))}),t._uU(7," YES "),t.qZA(),t.TgZ(8,"button",40),t.NdJ("click",function(){const c=t.CHM(e).$implicit;return t.KtG(c.dismiss("Cross click"))}),t._uU(9," NO "),t.qZA()()}}function a(r,F){if(1&r){const e=t.EpF();t.TgZ(0,"tr")(1,"td",26),t._uU(2),t.ALo(3,"titlecase"),t.qZA(),t.TgZ(4,"td",26),t._uU(5),t.qZA(),t.TgZ(6,"td",27),t._uU(7),t.qZA(),t.TgZ(8,"td",28)(9,"button",29),t.NdJ("click",function(){const c=t.CHM(e).$implicit,h=t.oxw();return t.KtG(h.updateWastage(c))}),t._UZ(10,"i",30),t.qZA(),t.TgZ(11,"button",31),t.NdJ("click",function(){const c=t.CHM(e).$implicit,h=t.MAs(14),x=t.oxw();return t.KtG(x.open(c._id,h))}),t._UZ(12,"i",32),t.qZA()(),t.YNc(13,p,10,0,"ng-template",null,33,t.W1O),t.qZA()}if(2&r){const e=F.$implicit;t.xp6(2),t.AsE(" ",e.productCode," - ",t.lcZ(3,4,e.productName)," "),t.xp6(3),t.Oqu(null==e?null:e.quantity),t.xp6(2),t.Oqu(e.remarks)}}let s=(()=>{class r{constructor(e,i,n,c){this.router=e,this.service=i,this.spinner=n,this.toastService=c,this.modalService=(0,t.f3M)(v.FF),this.page=1,this.pageSize=25,this.collection=0,this.column="createdAt",this.direction=-1,this.search="",this.category=[],this.allData=[],this.image=[]}ngOnInit(){this.getAll()}add(){this.router.navigate(["/default/wastage/form"])}updateWastage(e){this.router.navigate(["/default/wastage/form"],{queryParams:{id:e._id}})}onChangePage(e){e>0&&(this.page=e),this.getAll()}open(e,i){this.selectedRow=e,this.modalService.open(i,{centered:!0})}searchFn(){(this.search.toString().length>=3||0==this.search.toString().length)&&this.getAll()}getAll(){this.spinner.show(),this.service.getAllWastage({page:this.page,pageSize:this.pageSize,search:this.search}).subscribe(i=>{this.spinner.hide(),this.allData=i.rows,this.collection=i.count})}delete(e){this.spinner.show(),this.service.deleteWastageById(e).subscribe(i=>{this.spinner.hide(),this.toastService.success(i.message),this.modalService.dismissAll(),this.getAll()})}static#t=this.\u0275fac=function(i){return new(i||r)(t.Y36(b.F0),t.Y36(A),t.Y36(C.t2),t.Y36(w._W))};static#e=this.\u0275cmp=t.Xpm({type:r,selectors:[["app-list"]],decls:34,vars:5,consts:[[1,"table-container"],[1,"card","table-card"],[1,"card-title"],[1,"card-header"],[1,"row","justify-content-between"],[1,"col-4"],[1,"input-icons"],[1,"input-group","input-group-sm"],["type","search","aria-label","Small","placeholder","Search","aria-describedby","inputGroup-sizing-sm",1,"form-control",3,"ngModel","ngModelChange","input"],[1,"input-group-append"],["id","inputGroup-sizing-sm",1,"input-group-text","h-100"],[1,"ti","ti-search"],[1,"col-md-4","col-3","text-right"],[1,"btn","add-btn",3,"click"],[1,"ti","ti-plus","me-1"],[1,"card-body","p-3"],[1,"table-responsive"],[1,"table","table-hover","table-bordered","text-center"],[1,"thead"],[1,"table-secondary"],["scope","col"],["scope","col",1,"text-left"],["scope","col",1,"mx-auto","text-center"],[1,"tbody","mt-3"],[4,"ngFor","ngForOf"],[3,"page","pageSize","collection","pageChange","pageSizeChange","collectionChange","myOutput"],["scope","row"],["scope","row",1,"text-left"],["scope","row",1,"text-center"],["ngbTooltip","Edit",1,"btn","btn-sm","action-btn","mx-2",3,"click"],[1,"ti","ti-edit-circle"],["ngbTooltip","Delete",1,"btn","btn-sm","action-btn",3,"click"],[1,"ti","ti-trash"],["deleteModal",""],[1,"modal-header","border-0"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body","border-0"],["id","modal-basic-title",1,"modal-title","text-center"],[1,"modal-footer","justify-content-center","border-0"],["type","button",1,"btn","px-4","btn-outline-danger",3,"click"],["type","button",1,"btn","px-4","btn-outline-primary",3,"click"]],template:function(i,n){1&i&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3"),t._uU(4,"Wastage List"),t.qZA()(),t.TgZ(5,"div",3)(6,"div",4)(7,"div",5)(8,"div",6)(9,"div",7)(10,"input",8),t.NdJ("ngModelChange",function(h){return n.search=h})("input",function(){return n.searchFn()}),t.qZA(),t.TgZ(11,"div",9)(12,"span",10),t._UZ(13,"i",11),t.qZA()()()()(),t.TgZ(14,"div",12)(15,"button",13),t.NdJ("click",function(){return n.add()}),t._UZ(16,"i",14),t._uU(17," Add Wastage "),t.qZA()()()(),t.TgZ(18,"div",15)(19,"div",16)(20,"table",17)(21,"thead",18)(22,"tr",19)(23,"th",20),t._uU(24,"Product"),t.qZA(),t.TgZ(25,"th",20),t._uU(26,"Quantity"),t.qZA(),t.TgZ(27,"th",21),t._uU(28,"Remarks"),t.qZA(),t.TgZ(29,"th",22),t._uU(30,"Action"),t.qZA()()(),t.TgZ(31,"tbody",23),t.YNc(32,a,15,6,"tr",24),t.qZA()()(),t.TgZ(33,"app-custom-pagination",25),t.NdJ("pageChange",function(h){return n.page=h})("pageSizeChange",function(h){return n.pageSize=h})("collectionChange",function(h){return n.collection=h})("myOutput",function(){return n.onChangePage(n.page)}),t.qZA()()()()),2&i&&(t.xp6(10),t.Q6J("ngModel",n.search),t.xp6(22),t.Q6J("ngForOf",n.allData),t.xp6(1),t.Q6J("page",n.page)("pageSize",n.pageSize)("collection",n.collection))},dependencies:[g.sg,l.Fj,l.JJ,l.On,v._L,d.W,g.rS]})}return r})();var u=o(4087),m=o(485),f=o(6857),Z=o(4807);let y=(()=>{class r{constructor(e,i,n,c,h,x,k){this.formBuilder=e,this.router=i,this.spinner=n,this.validationService=c,this.activated=h,this.service=x,this.toastService=k,this.submitted=!1,this.productOptions=[],this.wastageForm=new l.cw({_id:new l.NI(null),productId:new l.NI(null,[l.kI.required]),quantity:new l.NI(null,[l.kI.required]),remarks:new l.NI(null),saleRates:new l.NI(null)}),this.FORM_ERRORS=[{message:"Product is Required",key:"productId"},{message:"Quantity is Required",key:"quantity"}]}get f(){return this.wastageForm.controls}ngOnInit(){this.getAllMasterData()}getAllMasterData(){this.service.getAllMasterData({}).subscribe(e=>{this.productOptions=e.products,this.activated.queryParams.subscribe(i=>{null!=i.id&&this.getDataById(i.id)})})}navigateTo(e){this.router.navigate([e])}submit(){if(this.submitted=!0,this.validationService.checkErrors(this.wastageForm,this.FORM_ERRORS))return;let e=this.wastageForm.value;e._id?this.update(e):(delete e._id,this.create(e))}create(e){this.spinner.show(),this.service.createWastage(e).subscribe(i=>{this.spinner.hide(),this.toastService.success(i.message),this.router.navigate(["default/wastage/list"])})}update(e){this.spinner.show(),this.service.updateWastageById(e._id,e).subscribe(i=>{this.spinner.hide(),this.toastService.success(i.message),this.router.navigate(["/default/wastage/list"])})}getDataById(e){this.spinner.show(),this.service.getById(e).subscribe(i=>{i.date&&(i.date=i.date.split("T")[0]),this.wastageForm.patchValue(i),this.spinner.hide()})}reset(){this.wastageForm.reset()}static#t=this.\u0275fac=function(i){return new(i||r)(t.Y36(l.qu),t.Y36(b.F0),t.Y36(u.V),t.Y36(f.R),t.Y36(b.gz),t.Y36(A),t.Y36(m.k))};static#e=this.\u0275cmp=t.Xpm({type:r,selectors:[["app-form"]],decls:41,vars:9,consts:[[1,"card","form-card"],[1,"card-header"],[1,"card-header-items"],[1,"back-btn","btn","btn-primary",3,"click"],[1,"ti","ti-arrow-left","me-1"],[1,"card-body"],[3,"formGroup"],[1,"row"],[1,"col-md-6","mb-2"],[1,"form-label"],[1,"text-danger"],["placeholder","Select Products","bindLabel","label","bindValue","_id","formControlName","productId",1,"ng-select-lg",3,"items","clearable"],["formControlName","quantity","placeholder","Quantity","type","number",1,"form-control"],[1,"col-md-12","mb-2"],["formControlName","remarks","placeholder","Remark","type","text",1,"form-control"],[1,"col-12"],[1,"d-flex","justify-content-center"],["type","submit",1,"btn","reset-btn","btn-primary",3,"click"],[1,"fa-solid","fa-arrows-rotate","me-2"],["type","submit",1,"btn","submit-btn",3,"click"],[1,"fa-solid","me-2"]],template:function(i,n){1&i&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div"),t._uU(4),t.qZA(),t.TgZ(5,"div")(6,"a",3),t.NdJ("click",function(){return n.navigateTo("/default/expenses/list")}),t._UZ(7,"i",4),t._uU(8," Back"),t.qZA()()()(),t.TgZ(9,"div",5)(10,"form",6)(11,"div",7)(12,"div",8)(13,"label",9),t._uU(14," Select Product "),t.TgZ(15,"span",10),t._uU(16,"*"),t.qZA()(),t._UZ(17,"ng-select",11),t.qZA(),t.TgZ(18,"div",8)(19,"label",9),t._uU(20," Wastage Quantity "),t.TgZ(21,"span",10),t._uU(22,"*"),t.qZA()(),t._UZ(23,"input",12)(24,"div"),t.qZA()(),t.TgZ(25,"div",7)(26,"div",13)(27,"label",9),t._uU(28," Remark "),t.qZA(),t._UZ(29,"input",14),t.qZA()(),t._UZ(30,"hr"),t.TgZ(31,"div",7)(32,"div",7)(33,"div",15)(34,"div",16)(35,"button",17),t.NdJ("click",function(){return n.reset()}),t._UZ(36,"i",18),t._uU(37," Reset "),t.qZA(),t.TgZ(38,"button",19),t.NdJ("click",function(){return n.submit()}),t._UZ(39,"i",20),t._uU(40),t.qZA()()()()()()()()),2&i&&(t.xp6(4),t.hij("",n.f._id.value?"Update":"Create"," Wastage"),t.xp6(6),t.Q6J("formGroup",n.wastageForm),t.xp6(7),t.Q6J("items",n.productOptions)("clearable",!1),t.xp6(21),t.Tol(n.f._id.value?"btn-warning":"btn-success"),t.xp6(1),t.Tol(n.f._id.value?"fa-pen-to-square":"fa-plus"),t.xp6(1),t.hij(" ",n.f._id.value?"Update":"Create"," "))},dependencies:[l._Y,l.Fj,l.wV,l.JJ,l.JL,l.sg,l.u,Z.w9]})}return r})();var I=o(4086);let M=[{path:"",redirectTo:"list",pathMatch:"full"},{path:"list",component:s},{path:"form",component:y}],W=(()=>{class r{static#t=this.\u0275fac=function(i){return new(i||r)};static#e=this.\u0275mod=t.oAB({type:r});static#i=this.\u0275inj=t.cJS({imports:[g.ez,l.UX,I.m,l.u5,d.W,b.Bz.forChild(M)]})}return r})()}}]);